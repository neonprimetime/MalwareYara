/* -------------------------
------ NanoCore ------------
--------------------------- */

rule NanoCoreByName
{
meta:
 author = "@neonprimetime"
 description = "NanoCore"
strings:
 $string0 = "NanoCore Client" nocase
 $string1 = "NanoCore.Client" nocase
 $string2 = "NanoCoreBase" nocase
 $string5 = "NanoCoreSwiss" nocase
 $string6 = "NanoCoreStressTester" nocase
condition:
 1 of them
}

rule NanoCoreByKeyword
{
meta:
 author = "@neonprimetime"
 description = "NanoCore"
strings:
 $string1 = "NanoBrowser" nocase
 $string2 = "NanoScript" nocase
 $string3 = "SurveillanceEx" nocase
 $string4 = "NanoCoreStressTester" nocase
 $string5 = "accident-investigation.aero" nocase
 $string6 = "KeyboardLogging" nocase
condition:
 3 of them
}

/* -------------------------
------ Remcos RAT-----------
--------------------------- */

rule RemcosRATByName
{
meta:
 author = "@neonprimetime"
 description = "Remcos RAT"
strings:
 $string0 = "Software\\Remcos" nocase
 $string1 = "\\remcos\\" nocase
 $string2 = "REMCOS v" nocase
 $string4 = "Remcos_" nocase
condition:
 1 of them
}

rule RemcosRATByKeyword
{
meta:
 author = "@neonprimetime"
 description = "Remcos RAT"
strings:
 $string1 = "Keylogger Started" nocase
 $string2 = "Connected to C&C" nocase
 $string3 = "Screenshots" nocase
 $string4 = "OpenCamera" nocase
 $string5 = "Uploading file to C&C" nocase
 $string6 = "Initializing connection to C&C" nocase
 $string7 = "cleared!]" nocase
 $string8 = "EnableLUA /t REG_DWORD /d 0" nocase
 $string9 = "RemWatchdog" nocase
 $string10 = "restarted by watchdog" nocase
condition:
 3 of them
}

/* -------------------------
------ Revil/Sodinokibi Ransomware-----------
--------------------------- */

rule RevilRansomwareByName
{
meta:
 author = "@neonprimetime"
 description = "Revil/Sodinokibi Ransomware"
strings:
 $string1 = "Sodinokibi" nocase
 $string2 = "For google: Revil" nocase
condition:
 any of them
}


rule RevilRansomwareByKeyword
{
meta:
 author = "@neonprimetime"
 description = "Revil/Sodinokibi Ransomware"
strings:
 $string1 = "decryptor.top" nocase
 $string2 = "nbody" nocase
 $string3 = "bedbg" nocase
condition:
 3 of them
}

/* -------------------------
------ NjRat -------------
--------------------------- */

rule NjRatByKeyword
{
meta:
 author = "@neonprimetime"
 description = "NjRat"
strings:

 $string0 = "vitimas_" nocase

$string1 = "|'|'||'|'|" nocase
condition:

 1 of them
}

/* -------------------------
------ Lokibot -------------
--------------------------- */

rule LokibotByKeyword
{
meta:
 author = "@neonprimetime"
 description = "Lokibot"
strings:
 $string0a = "five/fre.php" nocase
 $string0b = "Panel/five" nocase
 $string1 = "fre.php" nocase
 $string2 = "Yandex\\YandexBrowser" nocase
 $string3 = "\\Mozilla\\SeaMonkey\\profiles.ini" nocase
 $string4 = "POP3 Password" nocase
 $string5 = "Software\\SimonTatham\\PuTTY\\Sessions" nocase
 $string6 = "EasyFTP\\data" nocase
 $string7 = "aPLib v1.01" nocase
 $string8 = "wcx_ftp.ini" nocase
condition:
 $string0a or $string0b or ($string1 and ($string2 or $string3 or $string4 or $string5 or $string6 or $string7 or $string8))
}
/* -------------------------
------ Revenge RAT -------------
--------------------------- */

rule RevengeRATByName
{
meta:
 author = "@neonprimetime"
 description = "Revenge RAT"
strings:

 $string0 = "Revenge-RAT" nocase

condition:

 1 of them
}

rule RevengeRATByKeyword
{
meta:
 author = "@neonprimetime"
 description = "Revenge RAT"
strings:

 $capture1 = "Start Capture" nocase

 $capture2 = "CaptureScreen" nocase

 $dotnet1 = ".NET" nocase

 $agent1 = "FirewallProduct" nocase

 $agent2 = "AntiVirusProduct" nocase

 $exfil1 = "USERDOMAIN=" nocase

condition:

 $dotnet1 and ($capture1 or $capture2) and ($agent1 or $agent2) and $exfil1
}



/* -------------------------
------ BrushaLoader -------------
--------------------------- */

rule BrushaLoaderByKeyword
{
meta:
 author = "@neonprimetime"
 description = "BrushaLoader"
strings:
 $vbe = ".shellexecute" nocase
 $xyzdomain = "xyz" nocase
 $google = "www.google.com" nocase
condition:
 $vbe and $xyzdomain and $google
}


/* -------------------------
------ Agent Tesla -------------
--------------------------- */

rule AgentTeslaByKeyword
{
meta:
 author = "@neonprimetime"
 description = "Agent Tesla"
strings:
 $checkip1 = "checkip.aws" nocase
 $checkip2 = "checkip.amazon" nocase
 $smtpexfil1 = "smtp." nocase
 $smtpexfil2 = ":587" nocase
 $dotnet1 = ".net" nocase
condition:
 ($checkip1 or $checkip2) and ($smtpexfil1 or $smtpexfil2) and $dotnet1
}



/* -------------------------
------ Trickbot ------------
--------------------------- */

rule TrickbotByKeyword
{
meta:
 author = "@neonprimetime"
 description = "Trickbot"
strings:
 $string1 = "serialNumber=" nocase
 $string2 = "emailAddress=" nocase
 $string3 = "/snapshot/" nocase
 $string4 = "Login Data.bak" nocase
 $string5 = "Grab_Passwords_Chrome" nocase
 $string6 = "Dinkumware" nocase
 $string7 = "tablecredit_cards" nocase
 $string8 = "server_addresses" nocase
condition:
 3 of them
}


/* -------------------------
------ Azorult -------------
--------------------------- */

rule AzorultByKeyword
{
meta:
 author = "@neonprimetime"
 description = "Azorult"
strings:
 $string1 = "wallet.dat" nocase
 $string2 = "PasswordsList.txt" nocase
 $string3 = "timeout.exe" nocase
 $string4 = "Wscript.Shell" nocase
 $string5 = "dotbit.me" nocase
condition:
 3 of them
}
/* -------------------------
------ Netwire -------------
--------------------------- */

rule NetwireByName
{
meta:
 author = "@neonprimetime"
 description = "Netwire"
strings:
 $string1 = "SOFTWARE\\NetWire" nocase
condition:
 1 of them
}


/* ------------------------------

  -------- Emotete by Keyword -----

 -------------------------- */


rule EmotetByKeyword

{

 meta:
  author = "@neonprimetime"

  description = "Emotet Keyword"

 strings:

  $string1 = "acquiremailbox.exe" nocase
  $string2 = "fillmailbox.exe" nocase
  $string3 = "inboxmailbox.exe" nocase
  $string4 = "mailboxacquire.exe" nocase
  $string5 = "mailboxinbox.exe" nocase
  $string6 = "mailboxmailbox.exe" nocase
  $string7 = "manualmailbox.exe" nocase
  $string8 = "monthlymailbox.exe" nocase
  $string9 = "pdfmailbox.exe" nocase
  $string10 = "publishmailbox.exe" nocase
  $string11 = "deployinbox.exe" nocase
  $string12 = "inboxinbox.exe" nocase
  $string13 = "inboxnetsh.exe" nocase
  $string14 = "mailboxinbox.exe" nocase
  $string15 = "netshinbox.exe" nocase
  $string16 = "createatargets.exe" nocase
  $string17 = "ducktargets.exe" nocase
  $string18 = "restoretargets.exe" nocase
  $string19 = "sendtargets.exe" nocase

 condition:

   1 of them

}

/* -------------------------
------ Phoenix Keylogger -------------
--------------------------- */

rule PhoenixKeyloggerByName
{
meta:
 author = "@neonprimetime"
 description = "Phoenix Keylogger"
strings:
 $string1 = "Phoenix Keylogger" nocase
condition:
 1 of them
}



/* -------------------------
------ BetaBot -------------
--------------------------- */

rule BetaBotByKeyword
{
meta:
 author = "@neonprimetime"
 description = "BetaBot"
strings:
 $string1 = "OnAsyncDestroy" nocase

 $string2 = "OnDestroySubject" nocase

 $string3 = "OnRemoveExisting" nocase

 $string4 = "ccnumber" nocase
condition:
 all of them
}




/* -------------------------
------ Generic Malware -------------
--------------------------- */

rule GenericDotNetFramework

{

meta:
 author = "@neonprimetime"
 description = "Generic .NET Framework detection"


strings:

 $string1 = ".NETFramework"

condition:
 1 of them

}


rule GenericBitcoinStealer

{
meta:
 author = "@neonprimetime"
 description = "Generic Bitcoin Stealer"
strings:
 $string1 = "wallet.dat" nocase

 $string2 = "\\wallets\\" nocase

 $string3 = "\\Electrum" nocase

 $string4 = "Coins\\" nocase

 $string5 = "\\bitcoin" nocase

 $string6 = "\\monero" nocase

 $string7 = "electrum.dat" nocase

 $string8 = "wallet_path" nocase

condition:

 1 of them

}



rule GenericUPXPacker

{
meta:
 author = "@neonprimetime"
 description = "Generic UpX packet"
strings:
 $string1 = "UPX" nocase

condition:

 1 of them


}



rule GenericAutoItPacker

{
meta:
 author = "@neonprimetime"
 description = "Generic AutoItPacker"
strings:
 $string1 = "AutoIt" nocase

 $string2 = "Auto-It" nocase

condition:

 1 of them


}




rule GenericCreditCardStealer
{
meta:
 author = "@neonprimetime"
 description = "Generic Credit Card Stealer"
strings:
 $string1 = "ccnumber" nocase
 $string2 = "expirationmonth" nocase

 $string3 = "monthexpiration" nocase

 $string4 = "card_number" nocase

 $string5 = "securitycode=" nocase

 $string6 = "=amex" nocase

 $string7 = "=visa" nocase

 $string8 = "cardnumber" nocase

condition:
 1 of them
}

rule GenericWebTraffic
{
meta:
 author = "@neonprimetime"
 description = "Generic Web Traffic"
strings:
 $string1 = "Server: lighttpd" nocase
 $string2 = "Host: %s" nocase
 $string3 = "POST %s" nocase
 $string4 = ".php" nocase
condition:
 1 of them
}

rule GenericNetworkTraffic
{
meta:
 author = "@neonprimetime"
 description = "Generic Network Traffic"
strings:
 $string1 = /\..{2,3}\:\d+/ nocase
condition:

 1 of them
}


rule GenericScheduledTask
{
meta:
 author = "@neonprimetime"
 description = "Generic Scheduled Task"
strings:
 $string1 = "schtasks" nocase
condition:


 1 of them
}



rule GenericDomainFlag
{
meta:
 author = "@neonprimetime"
 description = "Generic Domain Flag from AD"
strings:
 $string1 = "/domain" nocase
condition:


 1 of them
}



rule GenericCreateFlag
{
meta:
 author = "@neonprimetime"
 description = "Generic Create Flag from AD"
strings:
 $string1 = "/create" nocase
condition:


 1 of them
}




rule GenericAddFlag
{
meta:
 author = "@neonprimetime"
 description = "Generic Add Flag from AD"
strings:
 $string1 = "/add" nocase
condition:


 1 of them
}






rule GenericSpamMailer
{
meta:
 author = "@neonprimetime"
 description = "Generic Spam Mailer"
strings:
 $string1 = "SEND FROM:" nocase
 $string2 = ":587" nocase
 $string3 = "smtp." nocase
condition:
 1 of them
}

rule GenericIPLookup
{
meta:
 author = "@neonprimetime"
 description = "Generic IP Lookup"
strings:
 $string1 = "checkip.amazonaws.com" nocase
 $string2 = "check-ip.aws." nocase

  $string3 = "ipecho.net" nocase
condition:
 1 of them
}

rule GenericWebcamAccess
{
meta:
 author = "@neonprimetime"
 description = "Generic Webcam Access"
strings:
 $string1 = "webcam" nocase
 $string2 = "OpenCamera" nocase
 $string3 = "CloseCamera" nocase
condition:
 1 of them
}
rule GenericScreenCapture
{
meta:
 author = "@neonprimetime"
 description = "Generic Screen Capture"
strings:
 $string1 = "CaptureScreen" nocase
condition:
 1 of them
}

rule GenericCredentialStealer
{
meta:
 author = "@neonprimetime"
 description = "Generic Credential Stealer"
strings:
 $string1 = "Profiles\\Outlook" nocase
 $string2 = "Login Data" nocase
 $string3 = "encryptedPassword" nocase
 $string4 = "HTTP Password" nocase
 $string5 = "\\profiles.ini" nocase
 $string6 = "\\POP3 Password" nocase
 $string7 = "PuTTY\\Sessions" nocase
 $string8 = "EasyFTP\\data" nocase
 $string9 = "Ftplist.txt" nocase
 $string10 = "\\Login Data" nocase
 $string11 = "\\ws_ftp.ini" nocase
 $string13 = "\\accounts.ini" nocase
 $string14 = "\\accounts.dat" nocase
 $string15 = "CREATE TABLE logins" nocase
 $string16 = "CREATE INDEX logins_signon" nocase
 $string17 = "DecryptIePassword" nocase
 $string18 = "GetSavedPasswords" nocase
 $string19 = "\\Passwords\\" nocase
 $string20 = "WinSCP 2\\Sessions" nocase
 $string21 = "\\HTTP Password" nocase
 $string22 = "\\IMAP Password" nocase
 $string23 = "\\SMTP Password" nocase
 $string24 = "\\HTTP Password" nocase
 $string25 = "[passwords]" nocase
 $string26 = "login-form" nocase
 $string27 = "recentservers.xml" nocase
 $string28 = "type=passwords" nocase
 $string29 = "user-password" nocase
 $string30 = "PasswordsList.txt" nocase
condition:


 1 of them
}
rule GenericBrowserHistoryStealer
{
meta:
 author = "@neonprimetime"
 description = "Generic Browser History Stealer"
strings:

 $string1 = "from urls" nocase

 $string2 = "from moz_places" nocase

condition:

 1 of them

}


rule GenericDataStealer
{
meta:
 author = "@neonprimetime"
 description = "Generic Data Stealer"
strings:
 $string0 = "\\User Data" nocase
 $string1 = "360Chrome\\" nocase
 $string2 = "7Star\\" nocase
 $string3 = "Cyberfox\\" nocase
 $string4 = "Amigo\\" nocase
 $string5 = "Apple Computer\\" nocase
 $string6 = "BraveSoftware\\" nocase
 $string7 = "CatalinaGroup\\" nocase
 $string8 = "CentBrowser\\" nocase
 $string9 = "Chedot\\" nocase
 $string10 = "Chromium\\" nocase
 $string11 = "Claws-mail\\" nocase
 $string12 = "CocCoc\\" nocase
 $string13 = "Comodo\\" nocase
 $string14 = "Coowon\\" nocase
 $string15 = "CoreFTP\\" nocase
 $string16 = "Elements Browser\\" nocase
 $string17 = "Epic Privacy Browser\\" nocase
 $string18 = "falkon\\" nocase
 $string19 = "Fenrir Inc\\" nocase
 $string20 = "FileZilla\\" nocase
 $string21 = "Flock\\" nocase
 $string22 = "FTPGetter\\" nocase
 $string23 = "Google\\" nocase
 $string24 = "Ipswitch\\" nocase
 $string25 = "Iridium\\" nocase
 $string26 = "K-Meleon\\" nocase
 $string27 = "Kometa\\" nocase
 $string28 = "liebao\\" nocase
 $string29 = "MapleStudio\\" nocase
 $string31 = "Moonchild Productions\\" nocase
 $string32 = "Mozilla\\" nocase
 $string35 = "NETGATE Technologies\\" nocase
 $string36 = "Opera Mail\\" nocase
 $string37 = "Opera Software\\" nocase
 $string38 = "Orbitum\\" nocase
 $string39 = "Pocomail\\" nocase
 $string40 = "Postbox\\" nocase
 $string41 = "Psi\\" nocase
 $string42 = "Psi+\\" nocase
 $string43 = "QIP Surf\\" nocase
 $string45 = "SmartFTP\\" nocase
 $string46 = "Sputnik\\" nocase
 $string47 = "Tencent\\" nocase
 $string48 = "The Bat!" nocase
 $string49 = "Thunderbird\\" nocase
 $string50 = "Torch\\" nocase
 $string51 = "Trillian\\" nocase
 $string52 = "UCBrowser\\" nocase
 $string53 = "uCozMedia\\" nocase
 $string54 = "VirtualStore\\" nocase
 $string55 = "Vivaldi\\" nocase
 $string56 = "Waterfox\\" nocase
 $string57 = "Yandex\\" nocase
 $string58 = "keychain.plist" nocase
 $string59 = "GetSavedCookies" nocase
 $string60 = "wcx_ftp.ini" nocase

$string61 = "Start Capture" nocase
 $string62 = "\\accounts.xml" nocase
 $string63 = "\\places.sqlite" nocase
 $string67 = "cookies.sqlite" nocase
condition:
 1 of them
}


rule GenericDeletesItself
{
meta:
 author = "@neonprimetime"
 description = "Generic Deletes Itself"
strings:
 $string1 = "DEL /s" nocase
 $string2 = "cmd /c del" nocase
 $string3 = "deleteSelf" nocase
 $string4 = "/c del %s" nocase
 $string5 = "%del" nocase
 $string6 = "& del" nocase
condition:


 1 of them
}




rule GenericMaliciousCommand
{
meta:
 author = "@neonprimetime"
 description = "Generic Malicious Command"
strings:
 $string1 = "CompSpec" nocase
condition:


 1 of them
}



rule GenericKeylogger
{
meta:
 author = "@neonprimetime"
 description = "Generic Keylogger"
strings:
 $string1 = "Keylog" nocase
 $string2 = "KeyboardLogging" nocase
 $string3 = "[Enter]" nocase
 $string4 = "[Ctrl + C]" nocase
 $string5 = "[Ctrl + V]" nocase
condition:
 1 of them
}



rule GenericDelay
{
meta:
 author = "@neonprimetime"
 description = "Generic Delay"
strings:
 $string1 = "ping 192" nocase
 $string2 = "ping 127" nocase
condition:
 1 of them
}
rule GenericSecurityToolDetection
{
meta:
 author = "@neonprimetime"
 description = "Generic Security Tool Detection"
strings:
 $string1 = "FROM FirewallProduct" nocase
 $string2 = "from AntiVirusProduct" nocase
condition:
 1 of them

}


rule GenericDisableAntivirus

{
meta:
 author = "@neonprimetime"
 description = "Generic Disable AntiVirus"
strings:
 $string1 = "DisableBehaviorMonitoring" nocase
 $string2 = "DisableOnAccessProtection" nocase

 $string3 = "DisableScanOnRealtime" nocase

 $string4 = "DisableRealtimeMonitoring" nocase

 $string5 = "DisableBlockAtFirstSeen" nocase

 $string6 = "DisableIOAVProtection" nocase

 $string7 = "DisableAntiSpyware" nocase

 $string8 = "DisableArchiveScanning" nocase

 $string9 = "DisableScriptScanning" nocase

 $string10 = "Set-MpPreference" nocase
condition:
 1 of them

}

rule GenericFirewallModification

{
meta:
 author = "@neonprimetime"
 description = "Generic Firewall Modifiction"
strings:
 $string1 = "netsh advfirewall" nocase
 $string2 = "firewall add" nocase
condition:
 1 of them

}


rule GenericPHPPanel
{
meta:
 author = "@neonprimetime"
 description = "Generic PHP Panel"
strings:

 $string1 = "/gate.php" nocase

 $string2 = "/fre.php" nocase

condition:

 1 of them

}

rule GenericBase64

{
meta:
 author = "@neonprimetime"
 description = "Generic PHP Panel"
strings:

 $string1 = /\=\=\r\n/ nocase

condition:

 1 of them

}



rule GenericDynamicDns


{
meta:
 author = "@neonprimetime"
 description = "Generic Dynamic DNS"
strings:

 $string1 = ".duckdns.org" nocase

condition:

 1 of them

}

rule GenericVisualBasicScript
{
meta:
 author = "@neonprimetime"
 description = "Generic Visual Basic Script"
strings:
 $string1 = ".shellexecute" nocase
 $string2 = "shell.application" nocase
 $string3 = "Wscript.Sleep" nocase
 $string4 = "ExecuteGlobal" nocase
 $string5 = "Shell.run" nocase
 $string6 = "Scripting.FileSystemObject" nocase
 $string7 = ":::const " nocase
 $string8 = "vbscontent" nocase
 $string9 = "Execute(" nocase
 $string10 = "ChrW(48) & ChrW(" nocase
 $string11 = "ChrW(48)&ChrW(" nocase
condition:
 1 of them
}

rule GenericHackerTerms
{

meta:
 author = "@neonprimetime"
 description = "Generic Hacker Terms"
strings:
 $string1 = "payloadpath" nocase
 $string2 = "payloadexist" nocase

condition:
 1 of them

}

rule GenericAntiDebug
{
meta:
 author = "@neonprimetime"
 description = "Generic Anti Debug techniques"
strings:
 $string1 = "CheckRemoteDebuggerPresent" nocase
condition:
 1 of them

}


rule GenericTor
{
meta:
 author = "@neonprimetime"
 description = "Generic Tor Dark Web"
strings:
 $string1 = "torproject.org" nocase
 $string2 = ".onion" nocase
 $string3 = "TOR browser" nocase
 
condition:
 1 of them

}



rule GenericPasswordList
{
meta:
 author = "@neonprimetime"
 description = "Generic Password List"
strings:
 $string1 = "peternorth" nocase
 $string2 = "motherfucker" nocase
 $string3 = "pimpdaddy" nocase
 $string4 = "ihavenopass" nocase
 $string5 = "fuckoff" nocase

 $string6 = "dickhead" nocase

 $string7 = "passw0rd" nocase

 $string8 = "changeme" nocase

condition:
 1 of them

}


rule GenericUserAgent
{
 meta:
  author = "@neonprimetime"
  description = "Generic User Agents oddities"
 strings:
  $string1 = "User-Agent: curl" nocase
  $string2 = "User-Agent: wget" nocase
 condition: 
  1 of them
}

rule GenericWebServer
{
 meta: 
  author = "@neonprimetime"
  description = "Generic Web Server info"
 strings: 
  $string1 = "nginx"
  $string2 = "apache"
 condition:
  1 of them
}

/* -------------------------
------ Community Created !!! BIG THANK YOU TO EVERYBODY WHO POSTS YARA RULES!!! ------------
--------------------------- */


rule CommunityCreated_revcode_mem
{
    meta:
        description = "Revcode RAT"
        author = "James_inthe_box"
        reference = "ee1b9659f2193896ce3469b5f90b82af3caffcba428e8524be5a9fdf391d8dd8"
        date = "2020/02"
        maltype = "RAT"
 
    strings:
        $string1 = "SCREEN_STREAM_START"
        $string2 = "CLIPBOARD_SET"
        $string3 = "SERVICES_RESUME"
        $string4 = "KEYLOG:"
        $string5 = "WEBCAM_DRIVERS"
        $string6 = "image.bmp" wide
        $string7 = "APPACTIVATE" wide
 
    condition:
        all of ($string*) and filesize > 1800KB
}


rule CommunityCreated_ta505_unpacked_mem
{
    meta:
        description = "TA505 loader"
        author = "James_inthe_box"
        reference = "4a3515f660ff5b938b73d1642a464fd87f3b694d4a09f23a94a14be4d95b7226"
        date = "2020/01"
        maltype = "Loader"
 
    strings:
        $string1 = "Failed to inject the DLL" ascii
        $string2 = "connection reset" ascii
        $string3 = "shutdown /r /t" ascii
        $string4 = "&OS=" wide
        $string5 = "&OSA=" wide
        $string6 = "&PR=" wide
        $string7 = "Reflective" ascii
 
    condition:
        all of ($string*) and filesize > 400KB
}


rule CommunityCreated_k_404_keylogger_mem
{
    meta:
        description = "404k keylogger stealer"
        author = "James_inthe_box"
        reference = "dee0e0be670ab59a25129f2da51db6b7"
        date = "2019/01"
        maltype = "Keylogger"
 
    strings:
        $string1 = "opera_salt"
        $string2 = "set_loloa"
        $string3 = "PSWD | Client Name" wide
        $string4 = "api_paste_code" wide
        $string5 = "Lockdown2000" wide
        $string6 = "wow_logins" wide
 
    condition:
        all of ($string*) and filesize > 300KB
}


rule CommunityCreated_Parallax_mem
{
    meta:
        description = "Parallax RAT"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/2c605bca-dd95-45fc-a8a7-79a915d2b798"
        date = "2019/12"
        maltype = "RAT"
 
    strings:
        $string1 = "image/jpeg" wide ascii
        $string2 = "[Ctrl]" wide ascii
        $string3 = "Profile0" wide ascii
        $string4 = "Clipboard End" wide ascii
        $string5 = "\\Thunderbird\\" wide ascii
        $string6 = "DeleteFile(Wscript.ScriptFullName)" wide ascii
        $string7 = "\\Key4.db" wide ascii
        $string8 = "Clipboard Start" wide ascii
        $string9 = "[Alt]" wide ascii
 
    condition:
        all of ($string*) and filesize > 200KB
}



rule CommunityCreated_AldiBot_mem
{
    meta:
        description = "Aldibot"
        author = "James_inthe_box"
        reference = "401567605f96c69d155d9d442e60031dbdab7d3fe8d13d2365d50684dab275b9"
        date = "2019/11"
        maltype = "Bot"
 
    strings:
        $string1 = "/gate.php?hwid="
        $string2 = "&pc="
        $string3 = "&localip="
        $string4 = "&winver="
        $string5 = "StopHTTPDDoS"
        $string6 = "StopTCPDDoS"
 
    condition:
        all of ($string*) and filesize > 300KB
}


rule CommunityCreated_AgentTesla_mod_tough_mem
 
{
    meta:
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/3b5d409c-978b-4a95-a5f1-399f0216873d/"
        date = "2019/11"
        maltype = "RAT"
 
    strings:
        $string1 = "Opera Software\\Opera Stable" wide ascii
        $string2 = "keychain.plist" wide ascii
        $stringset1 = "type={0}" ascii wide
        $stringset2 = "hwid={1}" ascii wide
        $stringset3 = "time={2}" ascii wide
        $stringset4 = "pcname={3}" ascii wide
        $stringset5 = "logdata={4}" ascii wide
        $stringset6 = "screen={5}" ascii wide
        $stringset7 = "ipadd={6}" ascii wide
        $stringset8 = "webcam_link={7}" ascii wide
        $stringset9 = "screen_link={8}" ascii wide
        $stringset10 = "[passwords]" ascii wide
 
    condition:
        all of ($string*) and 5 of ($stringset*)
}


rule CommunityCreated_Real_thin_client_bin_mem
{
    meta:
        description = "Real Thin Client"
        author = "James_inthe_box"
        reference = "614772bdee2983b11b3569e22afa3449c0d1f54031896af9504959b473fedb36"
        date = "2019/11"
        maltype = "RAT"
 
    strings:
        $string1 = "$CLI-CRYPT$" wide ascii
        $string2 = "$CLI-OBJM$" wide ascii
        $string3 = "CLIMOD.CALL$" wide ascii
        $string4 = "CLIMOD.LOGIN$" wide ascii
        $string5 = "RTC Client" wide ascii
 
    condition:
        all of ($string*) and filesize > 800KB
}


rule CommunityCreated_Blackrat_mem
{
    meta:
        description = "Blackrat"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/df948de2-bd4f-431e-a4d8-dde5a17b9ff4"
        date = "2019/11"
        maltype = "RAT"
 
    strings:
        $string1 = "BC02.My"
        $string2 = "f3LrqnzkqCDx23N0zbGC"
        $string3 = "c8c8c4c4-b531-4925-8c71-925d272d2411"
 
    condition:
        all of ($string*) and filesize > 800KB
}

rule CommunityCreated_Get2_loader_mem
{
    meta:
        description = "Get2 loader"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/2df343eb-df3b-400d-affc-3bf04fa5484c/"
        date = "2019/10"
        maltype = "Loader"
 
    strings:
        $string1 = "&OS=" wide
        $string2 = "&OSA=" wide
        $string3 = "Failed to open the target process"
        $string4 = "Failed to inject the DLL"
        $string5 = "&PR=" wide
        $string6 = "\\lowpro" wide
        $string7 = "shutdown /r /t"
 
    condition:
        all of ($string*) and filesize > 800KB
}


rule CommunityCreated_JssHttp_loader_mem
{
    meta:
        description = "JssLoader"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/b6f6bfe1-c483-46c5-8abc-899c1e08f5d5"
        date = "2019/10"
        maltype = "Loader"
 
    strings:
        $string1 = "JssHttp"
        $string2 = "Host information report" wide
        $string3 = "End of report" wide
 
    condition:
        all of ($string*) and filesize > 100KB
}


rule CommunityCreated_IcedID_loader_mem
{
    meta:
        description = "IcedID Loader"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/27f86128-ab28-4f2b-975e-e85bc47aff58/"
        date = "2019/10"
        maltype = "Loader"
 
    strings:
        $string1 = "c:\\Users\\Public\\"
        $string2 = "\\photo.png"
        $string3 = "%0.2X%0.2X%0.2X%0.2X%0.2X%0.2X%0.8X"
        $string4 = "/photo.png?id=%0.2X%0.8X%0.8X%"
        $string5 = "GET" wide
        $string6 = "GetUserNameA"
        $string7 = "/index.php"
 
    condition:
        all of ($string*) and filesize > 100KB
}


rule CommunityCreated_Expiro_mem
{
    meta:
        description = "Expiro"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/c3c02897-5069-45d2-8add-2b3e194754ff"
        date = "2019/10"
        maltype = "Trojan"
 
    strings:
        $string1 = "wscsvc|WinDefend|MsMpSvc|NisSrv|gupdate|gupdatem|wuauserv"
        $string2 = "%s%c%c%c%c-%c%c%c%c%c.com"
        $string3 = "\\*.dat"
        $string4 = "User-Agent: %cozilla/%u.%u (%compatible; msie %u; %s; .NET CLR %s/%s)"
        $string5 = "No space left on device"
 
    condition:
        all of ($string*) and filesize > 900KB
}

rule CommunityCreated_DCRat_mem
{
    meta:
        description = "DCRat"
        author = "James_inthe_box"
        reference = "8d41d5131fac719cc11823fb57bef9ef1ea063dbb8f52b235a3948bece039d95"
        date = "2019/09"
        maltype = "RAT"
 
    strings:
        $string1 = "DCRatBuild"
 
    condition:
        all of ($string*) and filesize > 3000KB
}


rule CommunityCreated_AESDDOS_mem
{
    meta:
        description = "CloudDDOS"
        author = "James_inthe_box"
        reference = "3e617b40b552534565b24d43ace8c83711173256764f6c2b030ecfb582feeade"
        date = "2019/09"
        maltype = "Bot"
 
    strings:
        $string1 = "No such file or directory"
        $string2 = "No such device or address"
        $string3 = "@INFO:0.%d%%"
        $string4 = "Yow! Bad host lookup."
 
    condition:
        all of ($string*) and filesize > 300KB
}


rule CommunityCreated_Silence_proxy_mem
{
    meta:
        description = "Silence proxy bot"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/208214ee-94bc-43d1-baa8-dcbfb8d14a6a/"
        date = "2019/09"
        maltype = "Bot"
 
    strings:
        $string1 = "127.0.0.1"
        $string2 = "Microsoft Audit Service"
        $string3 = "blablabla"
        $string4 = "Application_client"
 
    condition:
        uint16(0) == 0x5A4D and all of ($string*) and filesize > 800KB
}


rule CommunityCreated_Raccoon_stealer_mem
{
    meta:
        description = "Raccoon Stealer"
        author = "James_inthe_box"
        reference = "161e393d9f16ea79c1d8356ec926f5bbf11568f5a322f1cd7216bcd12b4d2091"
        date = "2019/09"
        maltype = "Stealer"
 
    strings:
        $string1 = "attachment_url"
        $string2 = "loader_urls"
        $string3 = "[^:]://"
        $string4 = "POST" ascii wide
        $string5 = "SUBTYPE GUID="
        $string6 = "rg:\\stealer\\stealler\\json.hpp" wide
 
    condition:
        uint16(0) == 0x5A4D and all of ($string*) and filesize > 800KB
}


rule CommunityCreated_InnfiRAT_mem
{
    meta:
        description = "InnfiRAT"
        author = "James_inthe_box"
        reference = "https://www.zscaler.com/blogs/research/innfirat-new-rat-aiming-your-cryptocurrency-and-more"
        date = "2019/09"
        maltype = "RAT"
 
    strings:
        $string1 = "get_HWID"
        $string2 = "BitcoinWallet"
        $string3 = "get_Login"
        $string4 = "get_Password"
        $string5 = "VictimLogs"
        $string6 = "DockInfo"
        $string7 = "IVictimCallback"
 
    condition:
        all of ($string*) and filesize > 800KB
}


rule CommunityCreated_Osiris_mem
{
    meta:
        description = "Osiris"
        author = "James_inthe_box"
        reference = "0325714eeb2af235a0f543ad9e11b5d852a61be78c9ece308c651412d97edd39"
        date = "2019/08"
        maltype = "Banker"
 
    strings:
        $string1 = "MAKEITSAD"
        $string2 = "%s\\%d-%02d-%02d_%02d-%02d-%02d_%d.dat" wide
        $string3 = "has_existing.txt" wide
        $string4 = "LibVNCServer"
        $string5 = "/kpanel/"
        $string6 = "Fast Guard"
        $string7 = "BOTID"
 
    condition:
        all of ($string*) and filesize > 800KB
}


rule CommunityCreated_ArtraDownlaoder_mem
{
    meta:
        description = "Artra Downloader"
        author = "James_inthe_box"
        reference = "dcb8531b0879d46949dd63b1ac094f5588c26867805d0795e244f4f9b8077ed1"
        date = "2019/08"
        maltype = "Loader"
 
    strings:
        $string1 = "bqqmjdbujpo0y.xxx.gpsn.vsmfodpefe"
        $string2 = "=%s&st=%d"                                
        $string4 = "Content-length: %d"
        $string5 = "0I0N0V0\\0o0v0"
        $string6 = "ID=%s"
 
    condition:
        all of ($string*) and filesize > 100KB
}


rule CommunityCreated_Bifrost_mem
{
    meta:
        description = "Bifrost"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/455e0ded-beff-4f9d-8174-b032ac50c6c6"
        date = "2019/08"
        maltype = "RAT"
 
    strings:
        $string1 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run"
        $string2 = "TFloodParams"
        $string3 = "Range:bytes="
        $string4 = "Host:"
        $string5 = "Connection: keep-alive"
        $string6 = "User-Agent:"
        $string7 = "Content-Length:"
        $string8 = "Referer:"
 
    condition:
        all of ($string*) and filesize > 800KB
}


rule CommunityCreated_tRat_mem
{
    meta:
        description = "tRat"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/cd3d8d11-9bc5-44e4-b3b2-6325b808c273/"
        date = "2019/08"
        maltype = "RAT"
 
    strings:
        $string1 = "KL_START"
        $string2 = "&=O8"
        $string3 = "TJKeyLogger"
        $string4 = "tRat"
        $string5 = "Passwords.txt"
 
    condition:
        all of ($string*) and filesize > 800KB
}


rule CommunityCreated_GlitchPOS_mem
{
    meta:
        description = "GlitchPOS"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/9ff2b1a4-c847-47f4-94e2-c5b9e1fde66e/"
        date = "2019/08"
        maltype = "POS Malware"
 
    strings:
        $string1 = "\\d{13,19}\\W\\d{7}\\w*" wide
        $string2 = "vboxmrxnp" wide
        $string3 = "set exename=" wide
 
    condition:
        all of ($string*) and filesize > 80KB
}


rule CommunityCreated_Delf_mem
{
    meta:
        description = "Delf loader"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/04a0a774-dd16-43bd-a966-2a35ca66fe70/"
        date = "2019/08"
        maltype = "Loader"
 
    strings:
        $string1 = "User-Agent: License"
        $string2 = "gate.php?serial="
        $string3 = "license-success-ok-"
 
    condition:
        all of ($string*) and filesize > 800KB
}


rule CommunityCreated_Raaloader_mem
{
    meta:
        description = "Raaloader"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/e658d397-a560-4678-b8ce-0c0222384879"
        date = "2019/08"
        maltype = "Loader"
 
    strings:
        $string1 = "Connecting to: %s:%d"
        $string2 = "Connection with server terminated"
        $string4 = "Connected!"
        $string5 = "Console allocated!"
 
    condition:
        all of ($string*) and filesize > 80KB
}


rule CommunityCreated_Sarwent_mem
{
    meta:
        description = "Sarwent"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/6812075f-1785-494f-9624-eda8b19943c3/"
        date = "2019/09"
        maltype = "Bot"
 
    strings:
        $string1 = "Options.dat"
        $string2 = "1.tmp"
        $string3 = "2.tmp"
        $string4 = "&bits="
        $string5 = "&av="
        $string6 = "&status="
 
    condition:
        all of ($string*) and filesize > 1700KB
}


rule CommunityCreated_Darkrat_mem
{
    meta:
        description = "Darkrat"
        author = "James_inthe_box"
        reference = "https://github.com/albertzsigovits/malware-writeups/tree/master/DarkRATv2"
        date = "2019/08"
        maltype = "RAT"
 
    strings:
        $string1 = "Set objShell = WScript.CreateObject(\"WScript.Shell\")"
        $string2 = "&taskstatus="
        $string3 = "network reset"
        $string4 = "text/plain"
        $string5 = "&antivirus="
        $string6 = "request="
        $string7 = "&arch="
 
    condition:
        all of ($string*) and filesize > 600KB
}


rule CommunityCreated_Medusa_mem
{
    meta:
        description = "MedusaHTTP"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/68c8f400-eba5-4d6c-b1f1-8b07d4c014a4"
        date = "2019/08"
        maltype = "DDOS"
 
    strings:
        $string1 = "MacAddress"
        $string2 = "Internal.log"
        $string3 = "Failed"
        $string4 = "POST!"
        $string5 = "abc="
        $string6 = "xyz="
        $string7 = "slavicdragon"
        $string8 = "smartflood"
 
    condition:
        all of ($string*) and filesize > 800KB
}
 
 
rule CommunityCreated_NyanW0rm_mem
{
    meta:
        description = "NyanW0rm"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/1cb6ca71-f3d6-432b-a0c2-7be930826229/"
        date = "2019/08"
        maltype = "Bot"
 
    strings:
        $string1 = "BotSocket"
        $string2 = "|NW|" wide
 
    condition:
        all of ($string*) and filesize > 200KB
}


rule CommunityCreated_Uerlas_mem
{
    meta:
        description = "Uerlas"
        author = "James_inthe_box"
        reference = "1e9a6a7caf7c33487eb7f426a7fc411b501e2595462c59c2b3b0b624c9079e67"
        date = "2019/09"
        maltype = "Stealer"
 
    strings:
        $string1 = "/c route add %s mask 255.255.255.255 %S" wide
        $string2 = "/c route delete %s" wide
 
    condition:
        all of ($string*) and filesize > 7000KB
}


rule CommunityCreated_amadey_new_bin_mem
{
    strings:
        $string1 = "-LIBGCCW32-EH-2-SJLJ-GTHR-MINGW32"
        $string2 = "w32_sharedptr->size == sizeof(W32_EH_SHARED)"
        $string3 = "%s:%u: failed assertion `%s'"
        $string4 = "../../gcc/gcc/config/i386/w32-shared-ptr.c"
        $string5 = "GetAtomNameA (atom, s, sizeof(s)) != 0"
        $string6 = "BypassUAC"
        $string7 = "AutoRunCmd"
 
    condition:
        all of them
}

rule CommunityCreated_Aspire_stealer_dll_mem
{
    meta:
        description = "Aspire stealer"
        author = "James_inthe_box"
        reference = "e6a8de879fc52e5588dc963a40aaa7fe8b2059f9ea990d5491247b1c16238358"
        date = "2019/07"
        maltype = "Stealer"
 
    strings:
        $string1 = "action=connect&username=" wide
        $string2 = "&country=" wide
        $string3 = "&hardwareid=" wide
        $string4 = "&privileges=" wide
        $string5 = "&ip=" wide
        $string6 = "&os=" wide
        $string7 = "&gpu=" wide
        $string8 = "&cpu=" wide
        $string9 = "&av=" wide
 
    condition:
        all of ($string*) and filesize > 7000KB
}


rule CommunityCreated_Bolek_kbot_mem
{
    meta:
        description = "Bolek"
        author = "James_inthe_box"
        reference = ""
        date = "2019/07"
        maltype = "Stealer"
 
    strings:
        $string1 = "127.0.0.1"
        $string2 = "0.0.0.0:80"
        $string3 = "\\TOR.32"
        $string4 = "I'm a teapot"
 
    condition:
        all of ($string*) and filesize > 1000KB
}


rule CommunityCreated_Latentbot_mem
{
    meta:
        description = "Latentbot"
        author = "James_inthe_box"
        reference = "459bb35b47d71971fd34877c6ddf00be5a6ccd343856ae57098b5f67b7660ec3"
        date = "2019/07"
        maltype = "Bot"
 
    strings:
        $string1 = "Unknown" ascii
        $string2 = "AnsiString" ascii
        $string3 = "UnicodeString" ascii
        $string4 = "Key not found !" wide
        $string5 = "CONTENT-LENGTH" wide
        $string6 = "TRANSFER-ENCODING" wide
        $string7 = "USER-AGENT" wide
        $string8 = "REFERER" wide
        $string9 = "HTTPS/1." wide
        $string10 = "COOKIE" wide
        $string11 = "X-FORWARDED-FOR" wide
        $string12 = "SET-COOKIE" wide
        $string13 = "Content-Disposition: form-data; name=\"" wide
        $string14 = "RTC Client" wide
        $string15 = "LoginPassword"
        $string16 = "LoginUserInfo"
        $string17 = "HELLO" wide
        $string18 = "ACTION" wide
        $string19 = "START" wide
 
    condition:
        all of ($string*) and filesize > 4000KB
}


rule CommunityCreated_Buran_mem
{
    meta:
        description = "Buran ransomware"
        author = "James_inthe_box"
        reference = "c201b67cb570829122d710c2259d5342cb7c23a8e524290f0c371e68f410664b"
        date = "2019/07"
        maltype = "Ransomware"
 
    strings:
        $string1 = "THIS IS BURAN"
 
    condition:
        all of ($string*) and filesize > 800KB
}
