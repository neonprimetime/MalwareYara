/* -------------------------
------ Ave Maria Stealer ------------
--------------------------- */

rule AveMariaByName
{
meta:
 author = "@neonprimetime"
 description = "Ave Maria Stealer"
strings:
 $string0 = "Ave_Maria" nocase
 $string1 = "Ave Maria" nocase
condition:
 1 of them
}

rule AveMariaByKeyword
{
meta:
 author = "@neonprimetime"
 description = "Ave Maria Stealer"
strings:
 $string1 = "Vital Kremez" nocase
 $string2 = "java-simple-mine-sweeper" nocase
condition:
 1 of them
}

/* -------------------------
------ Matiex Keylogger ------------
--------------------------- */

rule MatiexKeyloggerByName
{
meta:
 author = "@neonprimetime"
 description = "Matiex Keylogger"
strings:
 $string0 = "Matiex" nocase
 $string1 = "M-A-T-I-E-X" nocase
condition:
 1 of them
}

rule MatiexKeyloggerByKeyword
{
meta:
 author = "@neonprimetime"
 description = "Matiex Keylogger"
strings:
 $string1 = "TheRecoveredPSwdSender" nocase
 $string2 = "ThePSWDSenders" nocase
condition:
 1 of them
}

/* -------------------------
------ NanoCore ------------
--------------------------- */

rule NanoCoreByName
{
meta:
 author = "@neonprimetime"
 description = "NanoCore"
strings:
 $string0 = "NanoCore Client" nocase
 $string1 = "NanoCore.Client" nocase
 $string2 = "NanoCoreBase" nocase
 $string5 = "NanoCoreSwiss" nocase
 $string6 = "NanoCoreStressTester" nocase
condition:
 1 of them
}


rule NanoCoreByKeyword
{
meta:
 author = "@neonprimetime"
 description = "NanoCore"
strings:
 $string1 = "NanoBrowser" nocase
 $string2 = "NanoScript" nocase
 $string3 = "SurveillanceEx" nocase
 $string4 = "NanoCoreStressTester" nocase
 $string5 = "accident-investigation.aero" nocase
 $string6 = "KeyboardLogging" nocase
condition:
 3 of them
}

/* -------------------------
------ Remcos RAT-----------
--------------------------- */

rule RemcosRATByName
{
meta:
 author = "@neonprimetime"
 description = "Remcos RAT"
strings:
 $string0 = "Software\\Remcos" nocase
 $string1 = "\\remcos\\" nocase
 $string2 = "REMCOS v" nocase
 $string4 = "Remcos_" nocase
condition:
 1 of them
}

rule RemcosRATByKeyword
{
meta:
 author = "@neonprimetime"
 description = "Remcos RAT"
strings:
 $string1 = "Keylogger Started" nocase
 $string2 = "Connected to C&C" nocase
 $string3 = "Screenshots" nocase
 $string4 = "OpenCamera" nocase
 $string5 = "Uploading file to C&C" nocase
 $string6 = "Initializing connection to C&C" nocase
 $string7 = "cleared!]" nocase
 $string8 = "EnableLUA /t REG_DWORD /d 0" nocase
 $string9 = "RemWatchdog" nocase
 $string10 = "restarted by watchdog" nocase
condition:
 3 of them
}

/* -------------------------
------ FlawedAmmyy ------------
--------------------------- */

rule FlawedAmmyyByName
{
meta:
 author = "@neonprimetime"
 description = "FlawedAmmyy"
strings:
 $string0 = "Ammyy" nocase
condition:
 1 of them
}

/* -------------------------
------ Revil/Sodinokibi Ransomware-----------
--------------------------- */

rule RevilRansomwareByName
{
meta:
 author = "@neonprimetime"
 description = "Revil/Sodinokibi Ransomware"
strings:
 $string1 = "Sodinokibi" nocase
 $string2 = "For google: Revil" nocase
condition:
 any of them
}


rule RevilRansomwareByKeyword
{
meta:
 author = "@neonprimetime"
 description = "Revil/Sodinokibi Ransomware"
strings:
 $string1 = "decryptor.top" nocase
 $string2 = "nbody" nocase
 $string3 = "bedbg" nocase
condition:
 3 of them
}

/* -------------------------
------ NjRat -------------
--------------------------- */

rule NjRatByKeyword
{
meta:
 author = "@neonprimetime"
 description = "NjRat"
strings:

 $string0 = "vitimas_" nocase

$string1 = "|'|'||'|'|" nocase
condition:

 1 of them
}

/* -------------------------
------ Lokibot -------------
--------------------------- */

rule LokibotByKeyword
{
meta:
 author = "@neonprimetime"
 description = "Lokibot"
strings:
 $string0a = "five/fre.php" nocase
 $string0b = "Panel/five" nocase
 $string1 = "fre.php" nocase
 $string2 = "Yandex\\YandexBrowser" nocase
 $string3 = "\\Mozilla\\SeaMonkey\\profiles.ini" nocase
 $string4 = "POP3 Password" nocase
 $string5 = "Software\\SimonTatham\\PuTTY\\Sessions" nocase
 $string6 = "EasyFTP\\data" nocase
 $string7 = "aPLib v1.01" nocase
 $string8 = "wcx_ftp.ini" nocase
condition:
 $string0a or $string0b or ($string1 and ($string2 or $string3 or $string4 or $string5 or $string6 or $string7 or $string8))
}
/* -------------------------
------ Revenge RAT -------------
--------------------------- */

rule RevengeRATByName
{
meta:
 author = "@neonprimetime"
 description = "Revenge RAT"
strings:

 $string0 = "Revenge-RAT" nocase

condition:

 1 of them
}

rule RevengeRATByKeyword
{
meta:
 author = "@neonprimetime"
 description = "Revenge RAT"
strings:

 $capture1 = "Start Capture" nocase

 $capture2 = "CaptureScreen" nocase

 $dotnet1 = ".NET" nocase

 $agent1 = "FirewallProduct" nocase

 $agent2 = "AntiVirusProduct" nocase

 $exfil1 = "USERDOMAIN=" nocase

condition:

 $dotnet1 and ($capture1 or $capture2) and ($agent1 or $agent2) and $exfil1
}



/* -------------------------
------ BrushaLoader -------------
--------------------------- */

rule BrushaLoaderByKeyword
{
meta:
 author = "@neonprimetime"
 description = "BrushaLoader"
strings:
 $vbe = ".shellexecute" nocase
 $xyzdomain = "xyz" nocase
 $google = "www.google.com" nocase
condition:
 $vbe and $xyzdomain and $google
}


/* -------------------------
------ Agent Tesla -------------
--------------------------- */

rule AgentTeslaByKeyword
{
meta:
 author = "@neonprimetime"
 description = "Agent Tesla"
strings:
 $checkip1 = "checkip.aws" nocase
 $checkip2 = "checkip.amazon" nocase
 $smtpexfil1 = "smtp." nocase
 $smtpexfil2 = ":587" nocase
 $dotnet1 = ".net" nocase
 $scheduledTask1 = "schtasks.exe" nocase
 $scheduledTask2 = "/Create /TN" nocase
 $scheduledTask3 = "Updates\\" nocase
 $service = "RegSvcs.exe" nocase
 $postDetails1 = "%mailaddres%" nocase
 $postDetails2 = "%smtp%" nocase
 $postDetails3 = "%toemail%" nocase
condition:
 ( ($checkip1 or $checkip2) and ($smtpexfil1 or $smtpexfil2) and $dotnet1 ) or ($scheduledTask1 and $scheduledTask2 and $scheduledTask3 and $service) or ($postDetails1 or $postDetails2 or $postDetails3)
}



/* -------------------------
------ Trickbot ------------
--------------------------- */

rule TrickbotByKeyword
{
meta:
 author = "@neonprimetime"
 description = "Trickbot"
strings:
 $string1 = "serialNumber=" nocase
 $string2 = "emailAddress=" nocase
 $string3 = "/snapshot/" nocase
 $string4 = "Login Data.bak" nocase
 $string5 = "Grab_Passwords_Chrome" nocase
 $string6 = "Dinkumware" nocase
 $string7 = "tablecredit_cards" nocase
 $string8 = "server_addresses" nocase
condition:
 3 of them
}


/* -------------------------
------ Azorult -------------
--------------------------- */

rule AzorultByKeyword
{
meta:
 author = "@neonprimetime"
 description = "Azorult"
strings:
 $string1 = "wallet.dat" nocase
 $string2 = "PasswordsList.txt" nocase
 $string3 = "timeout.exe" nocase
 $string4 = "Wscript.Shell" nocase
 $string5 = "dotbit.me" nocase
condition:
 3 of them
}
/* -------------------------
------ Netwire -------------
--------------------------- */

rule NetwireByName
{
meta:
 author = "@neonprimetime"
 description = "Netwire"
strings:
 $string1 = "SOFTWARE\\NetWire" nocase
condition:
 1 of them
}


/* ------------------------------

  -------- Emotete by Keyword -----

 -------------------------- */


rule EmotetByKeyword

{

 meta:
  author = "@neonprimetime"

  description = "Emotet Keyword"

 strings:

  $string1 = "acquiremailbox.exe" nocase
  $string2 = "fillmailbox.exe" nocase
  $string3 = "inboxmailbox.exe" nocase
  $string4 = "mailboxacquire.exe" nocase
  $string5 = "mailboxinbox.exe" nocase
  $string6 = "mailboxmailbox.exe" nocase
  $string7 = "manualmailbox.exe" nocase
  $string8 = "monthlymailbox.exe" nocase
  $string9 = "pdfmailbox.exe" nocase
  $string10 = "publishmailbox.exe" nocase
  $string11 = "deployinbox.exe" nocase
  $string12 = "inboxinbox.exe" nocase
  $string13 = "inboxnetsh.exe" nocase
  $string14 = "mailboxinbox.exe" nocase
  $string15 = "netshinbox.exe" nocase
  $string16 = "createatargets.exe" nocase
  $string17 = "ducktargets.exe" nocase
  $string18 = "restoretargets.exe" nocase
  $string19 = "sendtargets.exe" nocase

 condition:

   1 of them

}

/* -------------------------
------ Phoenix Keylogger -------------
--------------------------- */

rule PhoenixKeyloggerByName
{
meta:
 author = "@neonprimetime"
 description = "Phoenix Keylogger"
strings:
 $string1 = "Phoenix Keylogger" nocase
condition:
 1 of them
}



/* -------------------------
------ BetaBot -------------
--------------------------- */

rule BetaBotByKeyword
{
meta:
 author = "@neonprimetime"
 description = "BetaBot"
strings:
 $string1 = "OnAsyncDestroy" nocase

 $string2 = "OnDestroySubject" nocase

 $string3 = "OnRemoveExisting" nocase

 $string4 = "ccnumber" nocase
condition:
 all of them
}




/* -------------------------
------ Generic Malware -------------
--------------------------- */

rule GenericPackedMalware
{
meta:
 author = "@neonprimetime"
 description = "Packed Malware"
strings:
 $string1 = "Jana Protector" nocase
 $string2 = "JanaProtector" nocase
 $string3 = "UPX" nocase
condition:
 any of them
}


rule GenericDotNetFramework

{

meta:
 author = "@neonprimetime"
 description = "Generic .NET Framework detection"


strings:

 $string1 = ".NETFramework"

condition:
 1 of them

}

rule GenericNamedPipes
{

meta:
 author = "@neonprimetime"
 description = "Generic named pipes"
strings:
 $string1 = "ClosePipe" nocase
 $string2 = "PipeExists" nocase
 $string3 = "PipeCreated" nocase
 $string4 = "PipeClosed" nocase
 $string5 = "CreatePipe" nocase
condition:
 1 of them
}

rule GenericDataExfiltration
{

meta:
 author = "@neonprimetime"
 description = "Generic data exfiltration"
strings:
 $string1 = "Exfiltrate" nocase
 $string2 = "/upload/" nocase
 $string3 = "SendToServer" nocase
condition:
 1 of them
}

rule GenericBitcoinStealer

{
meta:
 author = "@neonprimetime"
 description = "Generic Bitcoin Stealer"
strings:
 $string1 = "wallet.dat" nocase

 $string2 = "\\wallets\\" nocase

 $string3 = "\\Electrum" nocase

 $string4 = "Coins\\" nocase

 $string5 = "\\bitcoin" nocase

 $string6 = "\\monero" nocase

 $string7 = "electrum.dat" nocase

 $string8 = "wallet_path" nocase

condition:

 1 of them

}



rule GenericUPXPacker

{
meta:
 author = "@neonprimetime"
 description = "Generic UpX packet"
strings:
 $string1 = "UPX" nocase

condition:

 1 of them


}

rule GenericInterestingApiCalls

{
meta:
 author = "@neonprimetime"
 description = "Generic Interesting API Calls"
strings:
 $string1 = "ResumeThread" nocase
 $string2 = "VirtualAlloc" nocase
 $string3 = "WriteProcessMemory" nocase
 $string4 = "UnmapViewOfSection" nocase
 $string5 = "CreateProcessA" nocase
condition:
 1 of them


}

rule GenericAutoItPacker

{
meta:
 author = "@neonprimetime"
 description = "Generic AutoItPacker"
strings:
 $string1 = "AutoIt" nocase

 $string2 = "Auto-It" nocase

condition:

 1 of them


}




rule GenericCreditCardStealer
{
meta:
 author = "@neonprimetime"
 description = "Generic Credit Card Stealer"
strings:
 $string1 = "ccnumber" nocase
 $string2 = "expirationmonth" nocase

 $string3 = "monthexpiration" nocase

 $string4 = "card_number" nocase

 $string5 = "securitycode=" nocase

 $string6 = "=amex" nocase

 $string7 = "=visa" nocase

 $string8 = "cardnumber" nocase

condition:
 1 of them
}

rule GenericWebTraffic
{
meta:
 author = "@neonprimetime"
 description = "Generic Web Traffic"
strings:
 $string1 = "Server: lighttpd" nocase
 $string2 = "Host: %s" nocase
 $string3 = "POST %s" nocase
 $string4 = ".php" nocase
condition:
 1 of them
}

rule GenericNetworkTraffic
{
meta:
 author = "@neonprimetime"
 description = "Generic Network Traffic"
strings:
 $string1 = /\..{2,3}\:\d+/ nocase
condition:

 1 of them
}

rule GenericNetworkActivity
{
meta:
 author = "@neonprimetime"
 description = "Generic Network Activity"
strings:
 $string1 = "getsock" nocase
condition:

 1 of them
}


rule GenericScheduledTask
{
meta:
 author = "@neonprimetime"
 description = "Generic Scheduled Task"
strings:
 $string1 = "schtasks" nocase
condition:


 1 of them
}



rule GenericDomainFlag
{
meta:
 author = "@neonprimetime"
 description = "Generic Domain Flag from AD"
strings:
 $string1 = "/domain" nocase
condition:


 1 of them
}



rule GenericCreateFlag
{
meta:
 author = "@neonprimetime"
 description = "Generic Create Flag from AD"
strings:
 $string1 = "/create" nocase
condition:


 1 of them
}




rule GenericAddFlag
{
meta:
 author = "@neonprimetime"
 description = "Generic Add Flag from AD"
strings:
 $string1 = "/add" nocase
condition:


 1 of them
}






rule GenericSpamMailer
{
meta:
 author = "@neonprimetime"
 description = "Generic Spam Mailer"
strings:
 $string1 = "SEND FROM:" nocase
 $string2 = ":587" nocase
 $string3 = "smtp." nocase
condition:
 1 of them
}

rule GenericSmtpActivity
{
meta:
 author = "@neonprimetime"
 description = "Generic Smtp Activity"
strings:
 $string1 = "SmtpClient" nocase
condition:
 1 of them
}

rule GenericIPLookup
{
meta:
 author = "@neonprimetime"
 description = "Generic IP Lookup"
strings:
 $string1 = "checkip.amazonaws.com" nocase
 $string2 = "check-ip.aws." nocase

  $string3 = "ipecho.net" nocase
condition:
 1 of them
}

rule GenericNetworkSettingsChecks
{
meta:
 author = "@neonprimetime"
 description = "Generic Network Settings Checks"
strings:
 $string1 = "DefaultGateway" nocase
 $string2 = "EnableDHCP" nocase
 $string3 = "TCPAllowedPorts" nocase
 $string4 = "KeepAliveInterval" nocase
 $string5 = "Win32_NetworkAdapterConfiguration" nocase
 $string6 = "\\tcpip\\parameters" nocase
condition:
 1 of them
}


rule GenericWebcamAccess
{
meta:
 author = "@neonprimetime"
 description = "Generic Webcam Access"
strings:
 $string1 = "webcam" nocase
 $string2 = "OpenCamera" nocase
 $string3 = "CloseCamera" nocase
condition:
 1 of them
}

rule GenericIPLookupService
{
meta:
 author = "@neonprimetime"
 description = "IP Lookup Service"
strings:
 $string1 = "IPLogger" nocase
 $string2 = "icanhazip" nocase
 $string3 = "ip.anysrc" nocase
 $string4 = "whatismyipaddress" nocase
 $string5 = "ipinfo.io" nocase
 $string6 = "ipecho.net" nocase
 $string7 = "checkip.amazon" nocase
 $string8 = "ip-api.com" nocase
 $string9 = "ipify.org" nocase
 $string10 = "2ip.ua" nocase
 $string11 = "checip.dyndns" nocase
 $string12 = "wtfismyip" nocase
condition:
 1 of them
}


rule GenericCurseWords
{
meta:
 author = "@neonprimetime"
 description = "Curse Words"
strings:
 $string1 = "fuck" nocase
 $string2 = "shit" nocase
 $string3 = "bitch" nocase
 $string4 = "MidgetPorn" nocase

condition:
 1 of them
}

rule GenericTelegramC2
{
meta:
 author = "@neonprimetime"
 description = "Telegram C2"
strings:
 $string1 = "Telegram" nocase
condition:
 1 of them
}

rule GenericAudioCapture
{
meta:
 author = "@neonprimetime"
 description = "Generic Audio Capture"
strings:
 $string1 = "VoiceRecord" nocase
 $string2 = "UploadCliboard" nocase
condition:
 1 of them
}

rule GenericClipboardCapture
{
meta:
 author = "@neonprimetime"
 description = "Generic Clipboard Capture"
strings:
 $string1 = "ClipboardLogger" nocase
condition:
 1 of them
}

rule GenericScreenCapture
{
meta:
 author = "@neonprimetime"
 description = "Generic Screen Capture"
strings:
 $string1 = "CaptureScreen" nocase
 $string2 = "ScreenshotLogger" nocase
 $string3 = "TakeScreenshot" nocase
 $string4 = "ScreenshotSend" nocase
condition:
 1 of them
}

rule GenericRemoteDesktop
{
meta:
 author = "@neonprimetime"
 description = "Generic Remote Desktop Activity"
strings:
 $string1 = "RDP-Tcp" nocase
 $string2 = "RDPServer" nocase
 $string3 = "RDP Server" nocase
 $string4 = "RDP session" nocase
condition:
 1 of them
}

rule GenericBrowserHistoryStealer
{
meta:
 author = "@neonprimetime"
 description = "Generic Browser History Stealer"
strings:
 $string1 = "origin_url" nocase
 $string2 = "Stay logged in from this computer" nocase
 $string3 = "from urls" nocase
 $string4 = "from moz_places" nocase
condition:
 1 of them
}

rule GenericCredentialStealer
{
meta:
 author = "@neonprimetime"
 description = "Generic Credential Stealer"
strings:
 $string1 = "Profiles\\Outlook" nocase
 $string2 = "Login Data" nocase
 $string3 = "encryptedPassword" nocase
 $string4 = "HTTP Password" nocase
 $string5 = "\\profiles.ini" nocase
 $string6 = "\\POP3 Password" nocase
 $string7 = "PuTTY\\Sessions" nocase
 $string8 = "EasyFTP\\data" nocase
 $string9 = "Ftplist.txt" nocase
 $string10 = "\\Login Data" nocase
 $string11 = "\\ws_ftp.ini" nocase
 $string13 = "\\accounts.ini" nocase
 $string14 = "\\accounts.dat" nocase
 $string15 = "CREATE TABLE logins" nocase
 $string16 = "CREATE INDEX logins_signon" nocase
 $string17 = "DecryptIePassword" nocase
 $string18 = "GetSavedPasswords" nocase
 $string19 = "\\Passwords\\" nocase
 $string20 = "WinSCP 2\\Sessions" nocase
 $string21 = "HTTP Password" nocase
 $string22 = "IMAP Password" nocase
 $string23 = "SMTP Password" nocase
 $string24 = "POP3 Password" nocase
 $string25 = "[passwords]" nocase
 $string26 = "login-form" nocase
 $string27 = "recentservers.xml" nocase
 $string28 = "type=passwords" nocase
 $string29 = "user-password" nocase
 $string30 = "PasswordsList.txt" nocase
 $string31 = "UploadPassword" nocase
 $string32 = "vaultcli.dll" nocase
condition:


 1 of them
}


rule GenericDataStealer
{
meta:
 author = "@neonprimetime"
 description = "Generic Data Stealer"
strings:
 $string0 = "\\User Data" nocase
 $string1 = "360Chrome\\" nocase
 $string2 = "7Star\\" nocase
 $string3 = "Cyberfox\\" nocase
 $string4 = "Amigo\\" nocase
 $string5 = "Apple Computer\\" nocase
 $string6 = "BraveSoftware\\" nocase
 $string7 = "CatalinaGroup\\" nocase
 $string8 = "CentBrowser\\" nocase
 $string9 = "Chedot\\" nocase
 $string10 = "Chromium\\" nocase
 $string11 = "Claws-mail\\" nocase
 $string12 = "CocCoc\\" nocase
 $string13 = "Comodo\\" nocase
 $string14 = "Coowon\\" nocase
 $string15 = "CoreFTP\\" nocase
 $string16 = "Elements Browser\\" nocase
 $string17 = "Epic Privacy Browser\\" nocase
 $string18 = "falkon\\" nocase
 $string19 = "Fenrir Inc\\" nocase
 $string20 = "FileZilla\\" nocase
 $string21 = "Flock\\" nocase
 $string22 = "FTPGetter\\" nocase
 $string23 = "Google\\" nocase
 $string24 = "Ipswitch\\" nocase
 $string25 = "Iridium\\" nocase
 $string26 = "K-Meleon\\" nocase
 $string27 = "Kometa\\" nocase
 $string28 = "liebao\\" nocase
 $string29 = "MapleStudio\\" nocase
 $string31 = "Moonchild Productions\\" nocase
 $string32 = "Mozilla\\" nocase
 $string35 = "NETGATE Technologies\\" nocase
 $string36 = "Opera Mail\\" nocase
 $string37 = "Opera Software\\" nocase
 $string38 = "Orbitum\\" nocase
 $string39 = "Pocomail\\" nocase
 $string40 = "Postbox\\" nocase
 $string41 = "Psi\\" nocase
 $string42 = "Psi+\\" nocase
 $string43 = "QIP Surf\\" nocase
 $string45 = "SmartFTP\\" nocase
 $string46 = "Sputnik\\" nocase
 $string47 = "Tencent\\" nocase
 $string48 = "The Bat!" nocase
 $string49 = "Thunderbird\\" nocase
 $string50 = "Torch\\" nocase
 $string51 = "Trillian\\" nocase
 $string52 = "UCBrowser\\" nocase
 $string53 = "uCozMedia\\" nocase
 $string54 = "VirtualStore\\" nocase
 $string55 = "Vivaldi\\" nocase
 $string56 = "Waterfox\\" nocase
 $string57 = "Yandex\\" nocase
 $string58 = "keychain.plist" nocase
 $string59 = "GetSavedCookies" nocase
 $string60 = "wcx_ftp.ini" nocase

$string61 = "Start Capture" nocase
 $string62 = "\\accounts.xml" nocase
 $string63 = "\\places.sqlite" nocase
 $string67 = "cookies.sqlite" nocase
condition:
 1 of them
}


rule GenericDeletesItself
{
meta:
 author = "@neonprimetime"
 description = "Generic Deletes Itself"
strings:
 $string1 = "DEL /s" nocase
 $string2 = "cmd /c del" nocase
 $string3 = "deleteSelf" nocase
 $string4 = "/c del %s" nocase
 $string5 = "%del" nocase
 $string6 = "& del" nocase
condition:


 1 of them
}




rule GenericMaliciousCommand
{
meta:
 author = "@neonprimetime"
 description = "Generic Malicious Command"
strings:
 $string1 = "CompSpec" nocase
condition:


 1 of them
}



rule GenericKeylogger
{
meta:
 author = "@neonprimetime"
 description = "Generic Keylogger"
strings:
 $string1 = "Keylog" nocase
 $string2 = "KeyboardLogging" nocase
 $string3 = "[Enter]" nocase
 $string4 = "[Ctrl + C]" nocase
 $string5 = "[Ctrl + V]" nocase
 $string6 = "KeyboardLogger" nocase
 $string7 = "StartKeylogger" nocase
 $string8 = "KeyLoggerEvent" nocase
 $string9 = "KeyDown" nocase
 $string10 = "KeyUp" nocase
 $string11 = "KeyboardState" nocase
 $string12 = "K-E-Y-L-O-G" nocase
condition:
 1 of them
}



rule GenericDelay
{
meta:
 author = "@neonprimetime"
 description = "Generic Delay"
strings:
 $string1 = "ping 192" nocase
 $string2 = "ping 127" nocase
condition:
 1 of them
}
rule GenericSecurityToolDetection
{
meta:
 author = "@neonprimetime"
 description = "Generic Security Tool Detection"
strings:
 $string1 = "FROM FirewallProduct" nocase
 $string2 = "from AntiVirusProduct" nocase
condition:
 1 of them

}

rule GenericPrivilegeEscalation
{
meta:
 author = "@neonprimetime"
 description = "Generic Privilege Escalation"
strings:
 $string1 = "Hey I'm Admin" nocase
 $string2 = "Elevation:Administrator" nocase
condition:
 1 of them

}

rule GenericProcessExecution
{
meta:
 author = "@neonprimetime"
 description = "Generic Process Execution"
strings:
 $string1 = "wmic process call create" nocase
 $string2 = "start-process" nocase
condition:
 1 of them

}

rule GenericDisableAntivirus

{
meta:
 author = "@neonprimetime"
 description = "Generic Disable AntiVirus"
strings:
 $string1 = "DisableBehaviorMonitoring" nocase
 $string2 = "DisableOnAccessProtection" nocase

 $string3 = "DisableScanOnRealtime" nocase

 $string4 = "DisableRealtimeMonitoring" nocase

 $string5 = "DisableBlockAtFirstSeen" nocase

 $string6 = "DisableIOAVProtection" nocase

 $string7 = "DisableAntiSpyware" nocase

 $string8 = "DisableArchiveScanning" nocase

 $string9 = "DisableScriptScanning" nocase

 $string10 = "Set-MpPreference" nocase
condition:
 1 of them

}

rule GenericFirewallModification

{
meta:
 author = "@neonprimetime"
 description = "Generic Firewall Modifiction"
strings:
 $string1 = "netsh advfirewall" nocase
 $string2 = "firewall add" nocase
condition:
 1 of them

}


rule GenericPHPPanel
{
meta:
 author = "@neonprimetime"
 description = "Generic PHP Panel"
strings:

 $string1 = "/gate.php" nocase

 $string2 = "/fre.php" nocase

condition:

 1 of them

}

rule GenericStartupPersistence
{
meta:
 author = "@neonprimetime"
 description = "Generic Startup Persistence"
strings:

 $string1 = "Software\\Microsoft\\Windows\\CurrentVersion\\Run\\" nocase

condition:

 1 of them

}


rule GenericDynamicDns


{
meta:
 author = "@neonprimetime"
 description = "Generic Dynamic DNS"
strings:

 $string1 = ".duckdns.org" nocase

condition:

 1 of them

}

rule GenericCloudFileStorage
{
meta:
 author = "@neonprimetime"
 description = "Generic Cloud File Storage"
strings:
 $string1 = "://drive.google.com" nocase
 $string2 = ".googleusercontent.com/" nocase
 $string3 = "?e=download" nocase
 $string4 = "export=download" nocase
condition:
 1 of them
}

rule Generic301Redirect
{
meta:
 author = "@neonprimetime"
 description = "Generic 301 Redirect"
strings:
 $string1 = "Moved Temporarily" nocase
 $string2 = "The document has moved" nocase
condition:
 1 of them
}


rule GenericVisualBasic6
{
meta:
 author = "@neonprimetime"
 description = "Generic Visual Basic 6 VB6 code"
strings:
 $string1 = "VB.TextBox" nocase
 $string2 = "MSVBVM60.DLL" nocase
condition:
 1 of them
}


rule GenericVisualBasicScript
{
meta:
 author = "@neonprimetime"
 description = "Generic Visual Basic Script"
strings:
 $string1 = ".shellexecute" nocase
 $string2 = "shell.application" nocase
 $string3 = "Wscript.Sleep" nocase
 $string4 = "ExecuteGlobal" nocase
 $string5 = "Shell.run" nocase
 $string6 = "Scripting.FileSystemObject" nocase
 $string7 = ":::const " nocase
 $string8 = "vbscontent" nocase
 $string9 = "Execute(" nocase
 $string10 = "ChrW(48) & ChrW(" nocase
 $string11 = "ChrW(48)&ChrW(" nocase
 $string12 = "Wscript.Shell" nocase
condition:
 1 of them
}

rule GenericHackerTerms
{

meta:
 author = "@neonprimetime"
 description = "Generic Hacker Terms"
strings:
 $string1 = "payloadpath" nocase
 $string2 = "payloadexist" nocase

condition:
 1 of them

}

rule GenericAntiDebug
{
meta:
 author = "@neonprimetime"
 description = "Generic Anti Debug techniques"
strings:
 $string1 = "CheckRemoteDebuggerPresent" nocase
 $string2 = "AntiBots" nocase
condition:
 1 of them

}


rule GenericTor
{
meta:
 author = "@neonprimetime"
 description = "Generic Tor Dark Web"
strings:
 $string1 = "torproject.org" nocase
 $string2 = ".onion" nocase
 $string3 = "TOR browser" nocase
 
condition:
 1 of them

}



rule GenericPasswordList
{
meta:
 author = "@neonprimetime"
 description = "Generic Password List"
strings:
 $string1 = "peternorth" nocase
 $string2 = "motherfucker" nocase
 $string3 = "pimpdaddy" nocase
 $string4 = "ihavenopass" nocase
 $string5 = "fuckoff" nocase
 $string6 = "dickhead" nocase
 $string7 = "passw0rd" nocase
 $string8 = "changeme" nocase

condition:
 1 of them

}


rule GenericUserAgent
{
 meta:
  author = "@neonprimetime"
  description = "Generic User Agents oddities"
 strings:
  $string1 = "User-Agent: curl" nocase
  $string2 = "User-Agent: wget" nocase
 condition: 
  1 of them
}

rule GenericWebServer
{
 meta: 
  author = "@neonprimetime"
  description = "Generic Web Server info"
 strings: 
  $string1 = "nginx" nocase
  $string2 = "apache" nocase
  $string3 = "Werkzeug" nocase
 condition:
  1 of them
}

/* -------------------------
------ Community Created !!! BIG THANK YOU TO EVERYBODY WHO POSTS YARA RULES!!! ------------
--------------------------- */


rule CommunityCreated_revcode_mem
{
    meta:
        description = "Revcode RAT"
        author = "James_inthe_box"
        reference = "ee1b9659f2193896ce3469b5f90b82af3caffcba428e8524be5a9fdf391d8dd8"
        date = "2020/02"
        maltype = "RAT"
 
    strings:
        $string1 = "SCREEN_STREAM_START"
        $string2 = "CLIPBOARD_SET"
        $string3 = "SERVICES_RESUME"
        $string4 = "KEYLOG:"
        $string5 = "WEBCAM_DRIVERS"
        $string6 = "image.bmp" wide
        $string7 = "APPACTIVATE" wide
 
    condition:
        all of ($string*) and filesize > 1800KB
}


rule CommunityCreated_ta505_unpacked_mem
{
    meta:
        description = "TA505 loader"
        author = "James_inthe_box"
        reference = "4a3515f660ff5b938b73d1642a464fd87f3b694d4a09f23a94a14be4d95b7226"
        date = "2020/01"
        maltype = "Loader"
 
    strings:
        $string1 = "Failed to inject the DLL" ascii
        $string2 = "connection reset" ascii
        $string3 = "shutdown /r /t" ascii
        $string4 = "&OS=" wide
        $string5 = "&OSA=" wide
        $string6 = "&PR=" wide
        $string7 = "Reflective" ascii
 
    condition:
        all of ($string*) and filesize > 400KB
}


rule CommunityCreated_k_404_keylogger_mem
{
    meta:
        description = "404k keylogger stealer"
        author = "James_inthe_box"
        reference = "dee0e0be670ab59a25129f2da51db6b7"
        date = "2019/01"
        maltype = "Keylogger"
 
    strings:
        $string1 = "opera_salt"
        $string2 = "set_loloa"
        $string3 = "PSWD | Client Name" wide
        $string4 = "api_paste_code" wide
        $string5 = "Lockdown2000" wide
        $string6 = "wow_logins" wide
 
    condition:
        all of ($string*) and filesize > 300KB
}


rule CommunityCreated_Parallax_mem
{
    meta:
        description = "Parallax RAT"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/2c605bca-dd95-45fc-a8a7-79a915d2b798"
        date = "2019/12"
        maltype = "RAT"
 
    strings:
        $string1 = "image/jpeg" wide ascii
        $string2 = "[Ctrl]" wide ascii
        $string3 = "Profile0" wide ascii
        $string4 = "Clipboard End" wide ascii
        $string5 = "\\Thunderbird\\" wide ascii
        $string6 = "DeleteFile(Wscript.ScriptFullName)" wide ascii
        $string7 = "\\Key4.db" wide ascii
        $string8 = "Clipboard Start" wide ascii
        $string9 = "[Alt]" wide ascii
 
    condition:
        all of ($string*) and filesize > 200KB
}



rule CommunityCreated_AldiBot_mem
{
    meta:
        description = "Aldibot"
        author = "James_inthe_box"
        reference = "401567605f96c69d155d9d442e60031dbdab7d3fe8d13d2365d50684dab275b9"
        date = "2019/11"
        maltype = "Bot"
 
    strings:
        $string1 = "/gate.php?hwid="
        $string2 = "&pc="
        $string3 = "&localip="
        $string4 = "&winver="
        $string5 = "StopHTTPDDoS"
        $string6 = "StopTCPDDoS"
 
    condition:
        all of ($string*) and filesize > 300KB
}


rule CommunityCreated_AgentTesla_mod_tough_mem
 
{
    meta:
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/3b5d409c-978b-4a95-a5f1-399f0216873d/"
        date = "2019/11"
        maltype = "RAT"
 
    strings:
        $string1 = "Opera Software\\Opera Stable" wide ascii
        $string2 = "keychain.plist" wide ascii
        $stringset1 = "type={0}" ascii wide
        $stringset2 = "hwid={1}" ascii wide
        $stringset3 = "time={2}" ascii wide
        $stringset4 = "pcname={3}" ascii wide
        $stringset5 = "logdata={4}" ascii wide
        $stringset6 = "screen={5}" ascii wide
        $stringset7 = "ipadd={6}" ascii wide
        $stringset8 = "webcam_link={7}" ascii wide
        $stringset9 = "screen_link={8}" ascii wide
        $stringset10 = "[passwords]" ascii wide
 
    condition:
        all of ($string*) and 5 of ($stringset*)
}


rule CommunityCreated_Real_thin_client_bin_mem
{
    meta:
        description = "Real Thin Client"
        author = "James_inthe_box"
        reference = "614772bdee2983b11b3569e22afa3449c0d1f54031896af9504959b473fedb36"
        date = "2019/11"
        maltype = "RAT"
 
    strings:
        $string1 = "$CLI-CRYPT$" wide ascii
        $string2 = "$CLI-OBJM$" wide ascii
        $string3 = "CLIMOD.CALL$" wide ascii
        $string4 = "CLIMOD.LOGIN$" wide ascii
        $string5 = "RTC Client" wide ascii
 
    condition:
        all of ($string*) and filesize > 800KB
}


rule CommunityCreated_Blackrat_mem
{
    meta:
        description = "Blackrat"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/df948de2-bd4f-431e-a4d8-dde5a17b9ff4"
        date = "2019/11"
        maltype = "RAT"
 
    strings:
        $string1 = "BC02.My"
        $string2 = "f3LrqnzkqCDx23N0zbGC"
        $string3 = "c8c8c4c4-b531-4925-8c71-925d272d2411"
 
    condition:
        all of ($string*) and filesize > 800KB
}

rule CommunityCreated_Get2_loader_mem
{
    meta:
        description = "Get2 loader"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/2df343eb-df3b-400d-affc-3bf04fa5484c/"
        date = "2019/10"
        maltype = "Loader"
 
    strings:
        $string1 = "&OS=" wide
        $string2 = "&OSA=" wide
        $string3 = "Failed to open the target process"
        $string4 = "Failed to inject the DLL"
        $string5 = "&PR=" wide
        $string6 = "\\lowpro" wide
        $string7 = "shutdown /r /t"
 
    condition:
        all of ($string*) and filesize > 800KB
}


rule CommunityCreated_JssHttp_loader_mem
{
    meta:
        description = "JssLoader"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/b6f6bfe1-c483-46c5-8abc-899c1e08f5d5"
        date = "2019/10"
        maltype = "Loader"
 
    strings:
        $string1 = "JssHttp"
        $string2 = "Host information report" wide
        $string3 = "End of report" wide
 
    condition:
        all of ($string*) and filesize > 100KB
}


rule CommunityCreated_IcedID_loader_mem
{
    meta:
        description = "IcedID Loader"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/27f86128-ab28-4f2b-975e-e85bc47aff58/"
        date = "2019/10"
        maltype = "Loader"
 
    strings:
        $string1 = "c:\\Users\\Public\\"
        $string2 = "\\photo.png"
        $string3 = "%0.2X%0.2X%0.2X%0.2X%0.2X%0.2X%0.8X"
        $string4 = "/photo.png?id=%0.2X%0.8X%0.8X%"
        $string5 = "GET" wide
        $string6 = "GetUserNameA"
        $string7 = "/index.php"
 
    condition:
        all of ($string*) and filesize > 100KB
}


rule CommunityCreated_Expiro_mem
{
    meta:
        description = "Expiro"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/c3c02897-5069-45d2-8add-2b3e194754ff"
        date = "2019/10"
        maltype = "Trojan"
 
    strings:
        $string1 = "wscsvc|WinDefend|MsMpSvc|NisSrv|gupdate|gupdatem|wuauserv"
        $string2 = "%s%c%c%c%c-%c%c%c%c%c.com"
        $string3 = "\\*.dat"
        $string4 = "User-Agent: %cozilla/%u.%u (%compatible; msie %u; %s; .NET CLR %s/%s)"
        $string5 = "No space left on device"
 
    condition:
        all of ($string*) and filesize > 900KB
}

rule CommunityCreated_DCRat_mem
{
    meta:
        description = "DCRat"
        author = "James_inthe_box"
        reference = "8d41d5131fac719cc11823fb57bef9ef1ea063dbb8f52b235a3948bece039d95"
        date = "2019/09"
        maltype = "RAT"
 
    strings:
        $string1 = "DCRatBuild"
 
    condition:
        all of ($string*) and filesize > 3000KB
}


rule CommunityCreated_AESDDOS_mem
{
    meta:
        description = "CloudDDOS"
        author = "James_inthe_box"
        reference = "3e617b40b552534565b24d43ace8c83711173256764f6c2b030ecfb582feeade"
        date = "2019/09"
        maltype = "Bot"
 
    strings:
        $string1 = "No such file or directory"
        $string2 = "No such device or address"
        $string3 = "@INFO:0.%d%%"
        $string4 = "Yow! Bad host lookup."
 
    condition:
        all of ($string*) and filesize > 300KB
}


rule CommunityCreated_Silence_proxy_mem
{
    meta:
        description = "Silence proxy bot"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/208214ee-94bc-43d1-baa8-dcbfb8d14a6a/"
        date = "2019/09"
        maltype = "Bot"
 
    strings:
        $string1 = "127.0.0.1"
        $string2 = "Microsoft Audit Service"
        $string3 = "blablabla"
        $string4 = "Application_client"
 
    condition:
        uint16(0) == 0x5A4D and all of ($string*) and filesize > 800KB
}


rule CommunityCreated_Raccoon_stealer_mem
{
    meta:
        description = "Raccoon Stealer"
        author = "James_inthe_box"
        reference = "161e393d9f16ea79c1d8356ec926f5bbf11568f5a322f1cd7216bcd12b4d2091"
        date = "2019/09"
        maltype = "Stealer"
 
    strings:
        $string1 = "attachment_url"
        $string2 = "loader_urls"
        $string3 = "[^:]://"
        $string4 = "POST" ascii wide
        $string5 = "SUBTYPE GUID="
        $string6 = "rg:\\stealer\\stealler\\json.hpp" wide
 
    condition:
        uint16(0) == 0x5A4D and all of ($string*) and filesize > 800KB
}


rule CommunityCreated_InnfiRAT_mem
{
    meta:
        description = "InnfiRAT"
        author = "James_inthe_box"
        reference = "https://www.zscaler.com/blogs/research/innfirat-new-rat-aiming-your-cryptocurrency-and-more"
        date = "2019/09"
        maltype = "RAT"
 
    strings:
        $string1 = "get_HWID"
        $string2 = "BitcoinWallet"
        $string3 = "get_Login"
        $string4 = "get_Password"
        $string5 = "VictimLogs"
        $string6 = "DockInfo"
        $string7 = "IVictimCallback"
 
    condition:
        all of ($string*) and filesize > 800KB
}


rule CommunityCreated_Osiris_mem
{
    meta:
        description = "Osiris"
        author = "James_inthe_box"
        reference = "0325714eeb2af235a0f543ad9e11b5d852a61be78c9ece308c651412d97edd39"
        date = "2019/08"
        maltype = "Banker"
 
    strings:
        $string1 = "MAKEITSAD"
        $string2 = "%s\\%d-%02d-%02d_%02d-%02d-%02d_%d.dat" wide
        $string3 = "has_existing.txt" wide
        $string4 = "LibVNCServer"
        $string5 = "/kpanel/"
        $string6 = "Fast Guard"
        $string7 = "BOTID"
 
    condition:
        all of ($string*) and filesize > 800KB
}


rule CommunityCreated_ArtraDownlaoder_mem
{
    meta:
        description = "Artra Downloader"
        author = "James_inthe_box"
        reference = "dcb8531b0879d46949dd63b1ac094f5588c26867805d0795e244f4f9b8077ed1"
        date = "2019/08"
        maltype = "Loader"
 
    strings:
        $string1 = "bqqmjdbujpo0y.xxx.gpsn.vsmfodpefe"
        $string2 = "=%s&st=%d"                                
        $string4 = "Content-length: %d"
        $string5 = "0I0N0V0\\0o0v0"
        $string6 = "ID=%s"
 
    condition:
        all of ($string*) and filesize > 100KB
}


rule CommunityCreated_Bifrost_mem
{
    meta:
        description = "Bifrost"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/455e0ded-beff-4f9d-8174-b032ac50c6c6"
        date = "2019/08"
        maltype = "RAT"
 
    strings:
        $string1 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run"
        $string2 = "TFloodParams"
        $string3 = "Range:bytes="
        $string4 = "Host:"
        $string5 = "Connection: keep-alive"
        $string6 = "User-Agent:"
        $string7 = "Content-Length:"
        $string8 = "Referer:"
 
    condition:
        all of ($string*) and filesize > 800KB
}


rule CommunityCreated_tRat_mem
{
    meta:
        description = "tRat"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/cd3d8d11-9bc5-44e4-b3b2-6325b808c273/"
        date = "2019/08"
        maltype = "RAT"
 
    strings:
        $string1 = "KL_START"
        $string2 = "&=O8"
        $string3 = "TJKeyLogger"
        $string4 = "tRat"
        $string5 = "Passwords.txt"
 
    condition:
        all of ($string*) and filesize > 800KB
}


rule CommunityCreated_GlitchPOS_mem
{
    meta:
        description = "GlitchPOS"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/9ff2b1a4-c847-47f4-94e2-c5b9e1fde66e/"
        date = "2019/08"
        maltype = "POS Malware"
 
    strings:
        $string1 = "\\d{13,19}\\W\\d{7}\\w*" wide
        $string2 = "vboxmrxnp" wide
        $string3 = "set exename=" wide
 
    condition:
        all of ($string*) and filesize > 80KB
}


rule CommunityCreated_Delf_mem
{
    meta:
        description = "Delf loader"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/04a0a774-dd16-43bd-a966-2a35ca66fe70/"
        date = "2019/08"
        maltype = "Loader"
 
    strings:
        $string1 = "User-Agent: License"
        $string2 = "gate.php?serial="
        $string3 = "license-success-ok-"
 
    condition:
        all of ($string*) and filesize > 800KB
}


rule CommunityCreated_Raaloader_mem
{
    meta:
        description = "Raaloader"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/e658d397-a560-4678-b8ce-0c0222384879"
        date = "2019/08"
        maltype = "Loader"
 
    strings:
        $string1 = "Connecting to: %s:%d"
        $string2 = "Connection with server terminated"
        $string4 = "Connected!"
        $string5 = "Console allocated!"
 
    condition:
        all of ($string*) and filesize > 80KB
}


rule CommunityCreated_Sarwent_mem
{
    meta:
        description = "Sarwent"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/6812075f-1785-494f-9624-eda8b19943c3/"
        date = "2019/09"
        maltype = "Bot"
 
    strings:
        $string1 = "Options.dat"
        $string2 = "1.tmp"
        $string3 = "2.tmp"
        $string4 = "&bits="
        $string5 = "&av="
        $string6 = "&status="
 
    condition:
        all of ($string*) and filesize > 1700KB
}


rule CommunityCreated_Darkrat_mem
{
    meta:
        description = "Darkrat"
        author = "James_inthe_box"
        reference = "https://github.com/albertzsigovits/malware-writeups/tree/master/DarkRATv2"
        date = "2019/08"
        maltype = "RAT"
 
    strings:
        $string1 = "Set objShell = WScript.CreateObject(\"WScript.Shell\")"
        $string2 = "&taskstatus="
        $string3 = "network reset"
        $string4 = "text/plain"
        $string5 = "&antivirus="
        $string6 = "request="
        $string7 = "&arch="
 
    condition:
        all of ($string*) and filesize > 600KB
}


rule CommunityCreated_Medusa_mem
{
    meta:
        description = "MedusaHTTP"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/68c8f400-eba5-4d6c-b1f1-8b07d4c014a4"
        date = "2019/08"
        maltype = "DDOS"
 
    strings:
        $string1 = "MacAddress"
        $string2 = "Internal.log"
        $string3 = "Failed"
        $string4 = "POST!"
        $string5 = "abc="
        $string6 = "xyz="
        $string7 = "slavicdragon"
        $string8 = "smartflood"
 
    condition:
        all of ($string*) and filesize > 800KB
}
 
 
rule CommunityCreated_NyanW0rm_mem
{
    meta:
        description = "NyanW0rm"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/1cb6ca71-f3d6-432b-a0c2-7be930826229/"
        date = "2019/08"
        maltype = "Bot"
 
    strings:
        $string1 = "BotSocket"
        $string2 = "|NW|" wide
 
    condition:
        all of ($string*) and filesize > 200KB
}


rule CommunityCreated_Uerlas_mem
{
    meta:
        description = "Uerlas"
        author = "James_inthe_box"
        reference = "1e9a6a7caf7c33487eb7f426a7fc411b501e2595462c59c2b3b0b624c9079e67"
        date = "2019/09"
        maltype = "Stealer"
 
    strings:
        $string1 = "/c route add %s mask 255.255.255.255 %S" wide
        $string2 = "/c route delete %s" wide
 
    condition:
        all of ($string*) and filesize > 7000KB
}


rule CommunityCreated_amadey_new_bin_mem
{
    strings:
        $string1 = "-LIBGCCW32-EH-2-SJLJ-GTHR-MINGW32"
        $string2 = "w32_sharedptr->size == sizeof(W32_EH_SHARED)"
        $string3 = "%s:%u: failed assertion `%s'"
        $string4 = "../../gcc/gcc/config/i386/w32-shared-ptr.c"
        $string5 = "GetAtomNameA (atom, s, sizeof(s)) != 0"
        $string6 = "BypassUAC"
        $string7 = "AutoRunCmd"
 
    condition:
        all of them
}

rule CommunityCreated_Aspire_stealer_dll_mem
{
    meta:
        description = "Aspire stealer"
        author = "James_inthe_box"
        reference = "e6a8de879fc52e5588dc963a40aaa7fe8b2059f9ea990d5491247b1c16238358"
        date = "2019/07"
        maltype = "Stealer"
 
    strings:
        $string1 = "action=connect&username=" wide
        $string2 = "&country=" wide
        $string3 = "&hardwareid=" wide
        $string4 = "&privileges=" wide
        $string5 = "&ip=" wide
        $string6 = "&os=" wide
        $string7 = "&gpu=" wide
        $string8 = "&cpu=" wide
        $string9 = "&av=" wide
 
    condition:
        all of ($string*) and filesize > 7000KB
}


rule CommunityCreated_Bolek_kbot_mem
{
    meta:
        description = "Bolek"
        author = "James_inthe_box"
        reference = ""
        date = "2019/07"
        maltype = "Stealer"
 
    strings:
        $string1 = "127.0.0.1"
        $string2 = "0.0.0.0:80"
        $string3 = "\\TOR.32"
        $string4 = "I'm a teapot"
 
    condition:
        all of ($string*) and filesize > 1000KB
}


rule CommunityCreated_Latentbot_mem
{
    meta:
        description = "Latentbot"
        author = "James_inthe_box"
        reference = "459bb35b47d71971fd34877c6ddf00be5a6ccd343856ae57098b5f67b7660ec3"
        date = "2019/07"
        maltype = "Bot"
 
    strings:
        $string1 = "Unknown" ascii
        $string2 = "AnsiString" ascii
        $string3 = "UnicodeString" ascii
        $string4 = "Key not found !" wide
        $string5 = "CONTENT-LENGTH" wide
        $string6 = "TRANSFER-ENCODING" wide
        $string7 = "USER-AGENT" wide
        $string8 = "REFERER" wide
        $string9 = "HTTPS/1." wide
        $string10 = "COOKIE" wide
        $string11 = "X-FORWARDED-FOR" wide
        $string12 = "SET-COOKIE" wide
        $string13 = "Content-Disposition: form-data; name=\"" wide
        $string14 = "RTC Client" wide
        $string15 = "LoginPassword"
        $string16 = "LoginUserInfo"
        $string17 = "HELLO" wide
        $string18 = "ACTION" wide
        $string19 = "START" wide
 
    condition:
        all of ($string*) and filesize > 4000KB
}


rule CommunityCreated_Buran_mem
{
    meta:
        description = "Buran ransomware"
        author = "James_inthe_box"
        reference = "c201b67cb570829122d710c2259d5342cb7c23a8e524290f0c371e68f410664b"
        date = "2019/07"
        maltype = "Ransomware"
 
    strings:
        $string1 = "THIS IS BURAN"
 
    condition:
        all of ($string*) and filesize > 800KB
}


rule CommunityCreated_Possible_new_hancitor_mem
{
    meta:
        description = "Possible new hancitor"
        author = "James_inthe_box"
        reference = "8e13ba3de370489b2ef72f4c0fe2d6986646783995f6331230d8a14ce1965400"
        date = "2019/07"
        maltype = "Loader"
 
    strings:
        $string1 = "%02X"
        $string2 = "VER=1&ID=%I64u&IP=%s"
        $string3 = "&DATA="
        $string4 = "\\%hs" wide
 
    condition:
        all of ($string*) and filesize > 100KB
}


rule CommunityCreated_Pitou_mem
{
    meta:
        description = "Pitou"
        author = "James_inthe_box"
        reference = "https://isc.sans.edu/diary/25068"
        date = "2019/06"
        maltype = "Spammer"
 
    strings:
        $string1 = "explorer.exe" wide
        $string2 = "Elevation:Administrator!new:" wide
        $string3 = "EFI PART"
        $string4 = "\\\\.\\C:"
        $string5 = "\\\\.\\PHYSICALDRIVE0"
        $string6 = ".pdb"
 
    condition:
        all of ($string*) and filesize > 800KB
}

rule CommunityCreated_TrueBot_mem
{
    meta:
        description = "TrueBot"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/131c3342-3edb-497a-a6dc-57975603ccc0/"
        date = "2019/02"
        maltype = "Loader"
 
    strings:
        $string1 = "api-ms-win-" wide
        $string2 = "Tntdll.dll" wide
        $string3 = "Content-Type: multipart/form-data; boundary=----qwerty"
        $string4 = "n=%x&o=%s&a=%d"
        $string5 = "%s\\temps.dat"
 
    condition:
        all of ($string*) and filesize > 200KB
}


rule CommunityCreated_Kpot_stealer_mem
{
    meta:
        description = "KPOT stealer"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/913b9afa-60f9-47fe-b3c5-b7cea0922c3c"
        date = "2019/05"
        maltype = "Stealer"
 
    strings:
        $string1 = "password-check"
        $string2 = "%s = %s"
        $string3 = "%s\\%s.txt" wide
        $string4 = "%s\\%s.vdf" wide
        $string5 = "%s\\%s\\%s-Qt" wide
        $string6 = "%s\\%s\\%s.xml" wide
        $string7 = "%s\\%s\\%s\\%.6s_%d.dat" wide
        $string8 = "_%s_"
 
    condition:
        all of ($string*) and filesize > 800KB
}


rule CommunityCreated_Sakari_mem
{
    meta:
        description = "Sakari Stealer"
        author = "James_inthe_box"
        reference = "f6031dee846b034b70bf33ba416f4244a7a34fd30c23d7bd4a2c98c2812e3c29"
        date = "2019/05"
        maltype = "Stealer"
 
    strings:
        $string2 = "*.vdf" wide
        $string3 = "cookies" wide
        $string5 = "win32_logicaldisk.deviceid=" wide
        $string6 = "VolumeSerialNumber" wide
 
    condition:
        all of ($string*) and filesize > 8000KB
}


rule CommunityCreated_Phorpiex_mem
{
    meta:
        description = "Phorpiex bot"
        author = "James_inthe_box"
        reference = "09fe7418de08ba5494e93c2404556dde88a03f440ead6323a2c6ec36f23a0fc4"
        date = "2019/05"
        maltype = "Bot"
 
    strings:
        $string1 = "Subject:"
        $string2 = "Message-ID:"
        $string3 = "http://icanhazip.com/"
        $string4 = "[0.0.0.0]"
        $string5 = "To:"
        $string6 = "RCPT TO:"
        $string7 = "Received: from"
 
    condition:
        all of ($string*) and filesize > 100KB
}


rule CommunityCreated_Anyplace_mem
{
    meta:
        description = "Anyplace RAT"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/34af67dd-ad68-45e2-baa9-3c4d3f4afce7"
        date = "2019/05"
        maltype = "RAT"
 
    strings:
        $string1 = "apc-settings.ini"
        $string2 = "IPADDRESS"
 
    condition:
        all of ($string*) and filesize > 800KB
}


rule CommunityCreated_Gh0st_Cringe_mem
{
    meta:
        description = "Gh0st-Cringe RAT"
        author = "James_inthe_box"
        reference = "62f02dd911ed52ffa87d1c8215199bfad471a7d5d0ef905eb16f45b0bb49ed94"
        date = "2019/05"
        maltype = "RAT"
 
    strings:
        $string1 = "PluginMe"
        $string2 = "%d.bak"
        $string3 = "System"
        $string4 = "Security"
        $string5 = "Application"
        $string6 = "Group"
        $string7 = "Remark"
        $string8 = "HARDWARE\\DESCRIPTION\\System\\CentralProcessor\\0"
        $secapp9 = "UnThreat"
        $secapp10 = "UnThreat.exe"
        $secapp11 = "K7TSecurity.exe"
        $secapp12 = "Ad-watch"
        $secapp13 = "ad-watch.exe"
        $secapp14 = "PSafe"
        $secapp15 = "PSafeSysTray.exe"
        $secapp16 = "BitDefender"
        $secapp17 = "vsserv.exe"
        $secapp18 = "remupd.exe"
        $secapp19 = "rtvscan.exe"
        $secapp20 = "Avast"
        $secapp21 = "ashDisp.exe"
        $secapp22 = "avcenter.exe"
        $secapp23 = "TMBMSRV.exe"
        $secapp24 = "knsdtray.exe"
        $secapp25 = "NOD32"
        $secapp26 = "egui.exe"
        $secapp27 = "Mcshield.exe"
        $secapp28 = "avp.exe"
        $secapp29 = "F-Secure"
        $secapp30 = "f-secure.exe"
        $secapp31 = "avgwdsvc.exe"
        $secapp32 = "AYAgent.aye"
        $secapp33 = "V3Svc.exe"
        $secapp34 = "Outpost"
        $secapp35 = "acs.exe"
        $secapp36 = "DR.WEB"
        $secapp37 = "SPIDer.exe"
        $secapp38 = "Comodo"
        $secapp39 = "cfp.exe"
        $secapp40 = "mssecess.exe"
        $secapp41 = "QuickHeal"
        $secapp42 = "QUHLPSVC.EXE"
        $secapp43 = "RavMonD.exe"
        $secapp44 = "KvMonXP.exe"
        $secapp46 = "baiduSafeTray.exe"
        $secapp47 = "BaiduSd.exe"
        $secapp48 = "QQPCRTP.exe"
        $secapp49 = "KSafeTray.exe"
        $secapp50 = "kxetray.exe"
        $secapp51 = "360sd.exe"
        $secapp52 = "360tray.exe"
        $secapp53 = "MSIE 6.0"
 
    condition:
        7 of ($string*) and 20 of ($secapp*) and filesize > 100KB
}

rule CommunityCreated_Krypton_mem
{
    meta:
        description = "Krypton stealer"
        author = "James_inthe_box"
        reference = "d4b908f9c294902196657c7b566046f058b2b58a63cfa49abf85e9e300bb8f14"
        date = "2019/05"
        maltype = "Stealer"
 
    strings:
        $string1 = "accounts="
        $string2 = "credit="
        $string3 = "file="
        $string4 = "crypto="
        $string5 = "cookie="
       
    condition:
        all of ($string*) and filesize > 600KB
}


rule CommunityCreated_Bandook_mem
{
    meta:
        description = "Bandook rat"
        author = "James_inthe_box"
        reference = "059296ebba9ab44684cf4af6ef19185b24584bc0a6c9efe1089d3cc022d689c2"
        date = "2019/04"
        maltype = "RAT"
 
    strings:
        $string1 = "<ellipsis>"
        $string2 = "https://wtfismyip.com/text"
        $string3 = "SELECT * FROM AntiVirusProduct"
        $string4 = "%s~!"
        $string5 = "TEST" wide
 
    condition:
        all of ($string*) and filesize > 1000KB
}


rule CommunityCreated_DiamondFox_mem
{
    meta:
        description = "DiamondFox stealer"
        author = "James_inthe_box"
        reference = "cbacda5748836543ceb8710d254f954ac4ec5b130a0fecfeb1205ef9d4e5def1"
        date = "2019/04"
        maltype = "Stealer"
 
    strings:
        $string1 = "POS_TIME"
        $string2 = "A_GRAB"
        $string3 = "<Panel>" wide
        $string4 = "&admin=" wide
        $string5 = "&user=" wide
        $string6 = "USERNAME" wide
        $string7 = "&gpu=" wide
 
    condition:
        all of ($string*) and filesize > 200KB
}


rule CommunityCreated_LimeRAT_mem
{
    meta:
        description = "LimeRAT"
        author = "James_inthe_box"
        reference = "d6955d8ae626ce1f4f2ca6f0a40805b9a14d6837e68083233944f0565bd855e1"
        date = "2019/04"
        maltype = "RAT"
 
    strings:
        $string1 = "LimeRAT" nocase ascii wide
 
    condition:
        all of ($string*)
}


rule CommunityCreated_Cybergate_mem
{
    meta:
        description = "CyberGate RAT"
        author = "James_inthe_box"
        reference = "772ccf76b072bbee94695a2f7894ce162f64f12ef953412d305daf43ff98e9fe"
        date = "2019/04"
        maltype = "RAT"
 
    strings:
        $string1 = "CyberGate" ascii wide
        $string2 = "[LogFile]"
 
    condition:
        all of ($string*) and filesize > 800KB
}


rule CommunityCreated_Mohazo_bot_mem
{
    meta:
        description = "Mohazo bot stealer"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/411a4cce-783c-4d3f-a57e-eb0c86de4e00"
        date = "2019/04"
        maltype = "Bot"
 
    strings:
        $string1 = "content-disposition: form-data; name=\""
        $string2 = "%[^:]"
        $string3 = "%99[^:]"
        $string4 = "loader_urls"
 
    condition:
        all of ($string*) and filesize > 800KB
}


rule CommunityCreated_Eightt_dll_mem
{
    meta:
        description = "8t crew malware"
        author = "James_inthe_box"
        reference = "853136f00e87a1ab3e2fc3acb309573e"
        date = "2019/04"
        maltype = "RAT"
 
    strings:
        $string1 = "taskkill /f /pid %s" wide
        $string2 = "reg delete H" wide
        $string3 = "ipconfig /flushdns" wide
        $string4 = "\\pxry.dat"
        $string5 = "passwd"
        $string6 = "OpenProcessToken Error: %d"
        $string7 = "rd /s/q \"%s\"" wide
 
    condition:
        all of ($string*) and filesize > 700KB
}


rule CommunityCreated_PasswordRecoveryChrome_mem
{
    meta:
        description = "PasswordRecoveryChrome"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/85249df8-bdf0-4b52-887e-e72d9dc2b7a4"
        date = "2019/04"
        maltype = "Stealer"
 
    strings:
        $string1 = "PasswordRecoveryChrome.exe"
        $string2 = "OpenPrinterW"
        $string3 = ".aspack"
        $string4 = "__dbk_fcall_wrapper"
 
    condition:
        all of ($string*) and filesize > 2000KB
}


rule CommunityCreated_Arcane_stealer_mem
{
    meta:
        description = "Arcane stealer"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/eabb7c12-b0f3-46f4-b3f4-ea26870d9841"
        date = "2019/04"
        maltype = "Stealer"
 
    strings:
        $string1 = "\\DashCore\\" wide
        $string2 = "wallet_path" wide
        $string3 = "Buy online at @arcanee_bot" wide
 
    condition:
       all of ($string*) and filesize > 100KB
}


rule CommunityCreated_Flawedgrace_mem
{
    meta:
        description = "Flawed Grace RAT"
        author = "James_inthe_box"
        reference = "e30c18f741916c335f7859b808929fa94295a708c19def4ca671f50909bdc225"
        date = "2019/03"
        maltype = "RAT"
 
    strings:
        $string1 = "AVGraceTunnelWriteThread"
        $string2 = "SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp" wide
 
    condition:
        all of ($string*) and filesize > 800KB
}

rule CommunityCreated_Teamspy_mem
{
    meta:
        description = "Teamspy"
        author = "James_inthe_box"
        reference = "b4c344d31e48903f200988bb10bf5fe838fb2b089a54b6c1c3004a80e037e1d0"
        date = "2019/03"
        maltype = "Backdoor"
 
    strings:
        $string1 = "\\Google\\Update\\GoogleUpdate.exe" wide
        $string2 = "Value_%d"
        $string3 = "Software\\localNETService"
        $string4 = "test"
        $string5 = "/chk" wide
        $string6 = ".dat"
        $string7 = "IgnoreNew"
 
    condition:
        all of ($string*) and filesize > 500KB
}


rule CommunityCreated_Teamspy_dll_mem
{
    meta:
        description = "Teamspy extracted dll"
        author = "James_inthe_box"
        reference = "b4c344d31e48903f200988bb10bf5fe838fb2b089a54b6c1c3004a80e037e1d0"
        date = "2019/03"
        maltype = "Backdoor"
 
    strings:
        $string1 = "client_id=%.8x&connected=%d&server_port=%d&debug=%d&os=%d.%d.%04d&dgt=%d&dti=%d"
 
    condition:
        all of ($string*) and filesize > 500KB
}

rule CommunityCreated_Arma_vmdetector_mem
{
    meta:
        description = "Arma VM Detector"
        author = "James_inthe_box"
        reference = "8ac05c6a588e6421b7de21aebaf2dbfeb3334d4ebf17caf6d5705874c0a72c5e"
        date = "2019/03"
        maltype = "Support"
 
    strings:
        $string1 = "arma.VmDetector.Win32"
        $string2 = "INFINITE"
        $string3 = "BIOS"
        $string4 = "BIOS_ROM_is_socketed"
        $string5 = "BIOS_shadowing_is_allowed"
        $string6 = "OEMStringArray" wide
        $string7 = "RegAsm.exe" wide
        $string8 = "/c copy" wide
 
 
    condition:
        all of ($string*) and filesize > 100KB
}


rule CommunityCreated_IModuleGetter_mem
{
    meta:
        description = "IModuleGetter loader"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/f435d89d-30a5-465b-8a8d-b7a042665e0e"
        date = "2019/03"
        maltype = "Loader"
 
    strings:
        $string1 = "System.Xml"
        $string2 = "IModuleGetter"
        $string3 = "XmlDictionaryReaderQuotas"
        $string4 = "%USERPROFILE%\\AppData\\Local\\Temp\\NetPlatform" wide
        $string5 = "_settings" wide
        $string6 = "net.tcp://{0}:23566/IModuleGetter" wide
 
    condition:
        all of ($string*) and filesize > 100KB
}

rule CommunityCreated_Baldr_mem
{
    meta:
        author = "James_inthe_box"
        reference = "e8adeee1736ee068f79284077ec905137051eaed11f0be53cc1977f30edb3102"
        date = "3/2019"
        maltype = "Infotealer"
 
    strings:
        $string1 = "_autocomplete.txt" wide
        $string2 = "hostname|encryptedPassword|encryptedUsername" wide
        $string3 = "cookieDomains.log" wide
        $string4 = "sitemanager.xml" wide
        $string5 = "Cards Count" wide
        $string6 = ".purple\\accounts.xml" wide
        $string7 = "ProtonVPN.exe_Url_" wide
        $string8 = "NordVPN.exe_Url_" wide
        $string9 = "Exodus\\exodus.wallet" wide
 
    condition:
        all of ($string*) and filesize > 800KB
}

rule CommunityCreated_Pirite_mem
{
    meta:
        description = "Pirite DDOS"
        author = "James_inthe_box"
        reference = "a0feae45be3494029aa3b605f33201d28a299dbfb8ca2ca851f3ac8ec604f16d"
        date = "2019/03"
        maltype = "DDOS"
 
    strings:
        $string1 = "x64"
        $string2 = "x86"
        $string3 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run"
        $string4 = "TFloodParams"
        $string5 = "calc.exe"
        $string6 = "127.0.0.1"
        $string7 = "Flood"
 
    condition:
        all of ($string*) and filesize > 10MB
}

rule CommunityCreated_Seagko_mem
{
    meta:
        description = "Seafko botnet"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/54fe7d78-91d9-4d45-8b65-7333c2c7d480"
        date = "2019/02"
        maltype = "Bot"
 
    strings:
        $string1 = "HTTPPayloads"
        $string2 = "DesktopScreenshot"
        $string3 = "DownloadExcute"
        $string4 = "Jan1St1970"
        $string5 = "SERVER_URL"
        $string6 = "STARTUP_INSTALL"
        $string7 = "IRCAgent"
        $string8 = "GetNickname"
        $string9 = "&command=RegisterNewMachine" wide
 
    condition:
        all of ($string*) and filesize > 800KB
}


rule CommunityCreated_Occamy_mem
{
    meta:
        description = "Occamy Eng Wiz rat"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/b71c1ef7-85b6-4e20-8bfb-e4c58ca6f8a4"
        date = "2019/02"
        maltype = "RAT"
 
    strings:
        $string1 = "RW5nIFdpei" wide
        $string2 = "(x86)" wide
        $string3 = "U01UUCBTZXJ2ZXI" wide
        $string4 = "VVJMOiA" wide
        $string5 = "IC9jIA" wide
 
 
    condition:
        all of ($string*) and filesize > 1MB
}

rule CommunityCreated_Flawedammyy_mem
{
    meta:
        description = "Flawed Ammyy RAT"
        author = "James_inthe_box"
        reference = "84259a3c6fd62a61f010f972db97eee69a724020af39d53c9ed1e9ecefc4b6b6"
        date = "2019/02"
        maltype = "RAT"
 
    strings:
        $string1 = "service.log" wide
        $string2 = "readme!!!.txt" wide
        $string3 = "Global\\Ammyy.Service" wide
        $string4 = "Ammyy Admin"
 
    condition:
        all of ($string*) and filesize > 800KB
}

rule CommunityCreated_Rietspoof_mem
{
    meta:
        description = "Rietspoof bot"
        author = "James_inthe_box"
        reference = "https://blog.avast.com/rietspoof-malware-increases-activity"
        date = "2019/02"
        maltype = "Downloader"
 
    strings:
        $string1 = "RAM:"
        $string2 = "CPU:"
        $string3 = "USER: admin"
        $string4 = "USER: user"
        $string5 = "data.dat"
 
    condition:
        all of ($string*) and filesize > 100KB
}

rule CommunityCreated_AgentZSZ_mem
{
    meta:
        description = "Agent.ZSZ loader"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/4852fe8a-a699-4067-b47a-91b98232ee5a"
        date = "2019/02"
        maltype = "Loader"
 
    strings:
        $string1 = "POST" wide
        $string2 = "http://" wide
        $string3 = "\\\\.\\PhysicalDrive0" wide
        $string4 = "WinHttpQueryAuthSchemes"
        $string5 = ".?AVlogic_error@std@@"
        $string6 = "InitializeSListHead"
        $string7 = "GetComputerNameExW"
        $string8 = ".gfids$x"
        $string9 = "WinHttpGetIEProxyConfigForCurrentUser"
        $string10 = "GetStartupInfoW"
 
    condition:
        all of ($string*) and filesize > 100KB
}

rule CommunityCreated_uPELoader_mem
{
    meta:
        description = "uPELoader"
        author = "James_inthe_box"
        reference = "ad83235d5eb8802283d0e7a10ddf0733dc3d5356d3f96eee42c1289d862c378c"
        date = "2019/01"
        maltype = "Loader"
 
    strings:
        $string1 = "z_stream"
        $string2 = "Win_Set_Info_Gad"
        $string3 = "Win_Run_Map_Gad"
        $string4 = ";uPELoader"
        $string5 = "SSEncrypt"
 
    condition:
        all of ($string*) and filesize > 400KB
}

rule CommunityCreated_phantom_nugget_mem
{
    meta:
        description = "Unknown"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/172f39cc-4ae1-4e66-97da-f631ce45dc87"
        date = "2019/01"
        maltype = "Unknown"
 
    strings:
        $string1 = "@TaskGuid"
        $string2 = "@ExecSign"
        $string3 = "@TaskSign"
        $string4 = "@NameID@"
        $string5 = "@DefGad@"
        $string6 = "@NetKey@"
        $string7 = "@SerUrlJM@"
        $string8 = "@SerNewIP@"
 
    condition:
        all of ($string*) and filesize > 400KB
}

rule CommunityCreated_Vncold_hvnc_memory
{
        meta:
                author = "James_inthe_box"
                date = "2018/09"
                maltype = "Stealer"
 
        strings:
                $string1 = "(%S)_%08x-VNCOLD"
                $string2 = "#hvnc"
 
        condition:
                all of them
}

rule CommunityCreated_Peppy_mem
{
    meta:
        description = "Peppy bot"
        author = "James_inthe_box"
        reference = "https://app.any.run/tasks/85174c03-a296-404a-801b-426dc22538ba"
        date = "2019/01"
        maltype = "Bot"
 
    strings:
        $string1 = "edward"
        $string2 = "PingServer"
        $string3 = "tcpclient"
        $string4 = "ServerTCP2URL"
        $string5 = "2BFDE77CF6E9EFCD3C43D8CDBDBF020C266EDD68"
        $string6 = "ServerTASK2URL"
        $string7 = "ambh!p1and#-)"
        $string8 = "tiktiktuktuk" wide
        $string9 = "Hash Code:" wide
 
    condition:
        all of ($string*)
}

rule CommunityCreated_Agenttesla_new_bin_mem
{
    meta:
    author = "James_inthe_box"
    reference = "https://app.any.run/tasks/7d26c900-f772-4697-8bec-0c24f29e317c"
    date = "2019/01"
    maltype = "Infotealer"
 
    strings:
        $string1 = "Password could not decrypted." wide
    $string2 = "hostname|encryptedPassword|encryptedUsername" wide
    $string3 = "firefox.exe" wide
    $string4 = "IELibrary.dll"
    $string5 = "PROGRAMFILES" wide
   
    condition:
        all of ($string*)
}


rule CommunityCreated_Kutaki_mem
{
    meta:
        description = "Kutaki"
        author = " James_inthe_box"
        reference = "54a9855383674e1b5bb22d719846cfc76758bca65804b0fd217bc2efa28250de"
        date = "2019/01"
        maltype = "Bot"
 
    strings:
        $string1 = "S  u  r  e" wide
        $string2 = "saverbro" wide
        $string3 = "Want To Clear Log" wide
        $string4 = "achibat" wide
        $string5 = "LoginSucceeded"
 
    condition:
        all of ($string*)
}

rule CommunityCreated_Ryuk
{
    meta:
        description = "Ryuk"
        author = " James_inthe_box"
        reference = "https://app.any.run/tasks/d9ae261d-4504-4c5f-a381-682be7272494"
        date = "2018/12"
        maltype = "Ransomware"
 
    strings:
        $mz = { 4d 5a }
        $string1 = ".RYK" wide
        $string2 = "UNIQUE_ID_DO_NOT_REMOVE" wide
        $string3 = "RyukReadMe.txt" wide
        $string4 = "BTC wallet"
        $string5 = "No system is safe"
 
    condition:
        ($mz at 0) and (all of ($string*))
}

rule CommunityCreated_AveMaria_bin_mem
{
    meta:
        description = "AveMaria infostealer"
        author = " James_inthe_box"
        reference = "https://app.any.run/tasks/67362469-76df-4b19-bfda-5d95a2b4d179"
        date = "2018/12"
        maltype = "Infotealer"
 
    strings:
        $string1 = "127.0.0.2"
        $string2 = "profiles.ini" wide
        $string3 = "AVE_MARIA"
        $string4 = "MortyCrypter" wide
 
    condition:
        all of ($string*)
}

rule CommunityCreated_Retefe_mem
{
    meta:
        description = "Retefe"
        author = " James_inthe_box"
        reference = "https://app.any.run/tasks/e12aee8f-c137-4002-859c-cedc675c8536"
        date = "2018/12"
        maltype = "Banker"
 
    strings:
        $string1 = "http://127.0.0.1:5555"
        $string2 = "socat-windows"
        $string3 = "torbrowser"
        $string4 = "taskscheduler"
        $string5 = "chocolatey"
        $string6 = "SOCKS4A:127.0.0.1"
 
    condition:
        all of ($string*)
}


rule CommunityCreated_Firefoxx64_bin_mem
{
    meta:
        author = " James_inthe_box"
        reference = "https://app.any.run/tasks/7d5cd23b-ddfb-44c3-adb3-9777265382b0"
        date = "2018/12"
        maltype = "Infotealer"
 
    strings:
        $string1 = "Password could not decrypted." wide
        $string2 = "hostname|encryptedPassword|encryptedUsername" wide
        $string3 = "firefoxx64"
 
    condition:
        all of ($string*)
}


rule CommunityCreated_FF49PreemUp_mem
{
    meta:
        description = "FF infostealer"
        author = " James_inthe_box"
        reference = "https://app.any.run/tasks/4e438c30-34b4-4219-98f4-db396ec19565"
        date = "2018/12"
        maltype = "Infostealer"
 
    strings:
        $string1 = "ff49preemup_dll" ascii
        $string2 = "RS=" wide
        $string3 = "FF_V=" wide
        $string4 = "FF_S_Domain_brand=" wide
        $string5 = "FF_installed_admin=" wide
        $string6 = "FF_H=" wide
        $string7 = "FF_S=" wide
        $string8 = "FF_S_Domain=" wide
        $string9 = "FF_H_BRAND=" wide
        $string10 = "AC=" wide
        $string11 = "ff_bit64=" wide
 
    condition:
        all of ($string*)
}


rule CommunityCreated_DNSpionage_bin_mem
{
    meta:
        author = " James_inthe_box"
        date = "2018/12"
        maltype = "DNSpionage"
 
    strings:
        $string1 = "/Client/Login?id="
        $string2 = "commands:"
        $string3 = "Downloads"
        $string4 = "Uploads"
        $string5 = "Apps"
 
    condition:
        all of ($string*)
}


rule CommunityCreated_amadey_bin_mem
{
    meta:
        author = " James_inthe_box"
        date = "2018/11"
        maltype = "Amadey"
 
    strings:
        $string1 = "&pc="
        $string2 = "&un="
        $string3 = "&nm="
        $string4 = "AddAtomA"
 
    condition:
        all of ($string*)
}

rule CommunityCreated_Possible_Cobint_mem
{
    meta:
        description = "Cobint"
        author = "James_inthe_box"
        reference = "7e82aa131fd92a4d0aec5086e036be544be0dd84a20ba25ffda633a9fbb69c32"
        date = "2019/02"
        maltype = "Tool"
 
    strings:
        $regex1 = /https:\/\/[a-zA-Z0-9]{4,}\.[a-zA-Z0-9]{2,}\/[a-z]{21,}/ wide
        $string1 = "User-Agent:"
        $string2 = "Host:"
        $string3 = "tls-server-end-point:"
 
    condition:
        all of ($regex*) and all of ($string*) and filesize > 800KB
}
 
 
rule CommunityCreated_Azorult
{
    meta:
        author = " James_inthe_box"
        date = "2018/10"
        maltype = "Azorult"
 
    strings:
        $string1 = ".tmp" wide
        $strings = "</account>"
        $string3 = "</jid>" wide
        $string4 = "PsiPlus"
        $string5 = "</account>"
 
    condition:
        all of them
}


rule CommunityCreated_Ursnif
{
    meta:
        author = " James_inthe_box"
        date = "2018/10"
        maltype = "Ursnif"
 
    strings:
        $string1 = "%02u-%02u-%02u"
        $string2 = "version=%u&soft=%u&user=%08x%08x%08x%08x&server=%u&id=%u&type=%u&name=%s"
 
    condition:
        all of them
}

rule CommunityCreated_zeus
{
    meta:
        author = " James_inthe_box"
        date = "2018/10"
        maltype = "Zeus"
       
    strings:
        //$c1 = "%BOTID%"
        //$c2 = "%BOTNET%"
        $s1 = "http://www.google.com/webhp"
    $s2 = "Global\\%08X%08X%08X" wide
        $s3 = "RFB 003.003"
    $s4 = "%s%08x.%s" wide
     
    condition:
    3 of ($s*)
}


rule CommunityCreated_Danabot
{
    meta:
        author = " James_inthe_box"
        date = "2018/09"
        maltype = "Danabot"
 
    strings:
        $string1 = "SOFTWARE\\Far\\Plugins\\FTP\\Hosts" wide
        $string2 = "FAR Manager FTP" wide
        $string3 = "Software\\CoffeeCup Software\\Internet\\Proxy" wide
        $string4 = "\\FTPRush\\RushSite.xml" wide
        $string5 = "\\BitKinex\\bitkinex.ds" wide
        $string6 = "ExpanDrive" wide
        $string7 = "\\GPSoftware\\Directory Opus\\ConfigFiles\\ftp.oxc" wide
        $string8 = "Software\\South River Technologies\\WebDrive\\Connections" wide
        $string9 = "Software\\ORL\\WinVNC3" wide
        $string10 = "CamFrogMCU" wide
        $string11 = "MuxaSoft Dialer" wide
        /*
        $string12 = "SELECT GlobalValue FROM \"TGlobalSettings\" WHERE GlobalName=\"MagicNumber\""
        $string13 = "SELECT ServerName, Url, ServerUser, ServerPass, RemoteDir FROM \"TServers\""
        */
 
    condition:
        all of ($string*)
}


rule CommunityCreated_HawkEye_Reborn_v8
{
        meta:
                author = "James_inthe_box"
                date = "2018/08"
                maltype = "KeyLogger"
                filetype = "exe"
 
        strings:
                $key = "HawkEye Keylogger" wide
                $string1 = "Reborn v8" wide
                $string2 = "a.pomf.cat" wide
 
        condition:
                $key and all of ($string*)
}
